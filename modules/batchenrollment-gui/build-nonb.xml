<?xml version="1.0" encoding="UTF-8"?>
<project name="batchenrollment-gui" default="build">
    <description>
        Builds, tests, and runs the project batchenrollment-gui.
    </description>

    <!--
        NOTE: This file is used by the build system. The files generated by NetBeans are only kept for development.
     -->

    <dirname property="batchenrollment-gui.dir" file="${ant.file.batchenrollment-gui}"/>

    <import file="${batchenrollment-gui.dir}/../build-helpers.xml"/>

    <property name="batchenrollment-gui.build.dir" location="${batchenrollment-gui.dir}/build"/>
    <property name="batchenrollment-gui.src.dir" location="${batchenrollment-gui.dir}/src"/>
    <property name="batchenrollment-gui.lib.dir" location="${batchenrollment-gui.dir}/lib/swing-app-framework"/>
    <property name="batchenrollment-gui.dist.dir" location="${batchenrollment-gui.dir}/dist"/>

    <path id="lib.swing-app-framework.classpath">
        <fileset dir="${batchenrollment-gui.lib.dir}" includes="*.jar"/>
    </path>

    <path id="compile.classpath">
        <path refid="lib.bouncycastle.classpath"/>
        <path refid="lib.cert-cvc.classpath"/>
        <path refid="lib.commons-collections.classpath"/>
        <path refid="lib.commons-config.classpath"/>
        <path refid="lib.commons-lang.classpath"/>
        <path refid="lib.commons-logging.classpath"/>
        <path refid="lib.log4j.classpath"/>
        <path refid="lib.swing-app-framework.classpath"/>
        <path location="${mod.cesecore-common.lib}"/>
        <path location="${mod.ejbca-common.lib}"/>
        <path location="${mod.ejbca-ws-cli.lib}"/>
        <path location="${mod.ejbca-ws.lib}"/>
    </path>

    <target name="clean">
        <delete dir="${batchenrollment-gui.dist.dir}/"/>
    </target>

    <target name="jar" depends="build"/>

    <target name="build" depends="compile">
        <mkdir dir="${batchenrollment-gui.dist.dir}/lib"/>
        <copy todir="${batchenrollment-gui.dist.dir}/lib" flatten="true" verbose="false">
            <path refid="compile.classpath"/>
        </copy>
        <copy todir="${batchenrollment-gui.dist.dir}" file="${batchenrollment-gui.dir}/default_connect.properties" verbose="false"/>
        <pathconvert property="batchenrollment-gui.dependencies" pathsep=" ">
            <path>
                <fileset dir="${batchenrollment-gui.dist.dir}" includes="lib/*.jar"/>
            </path>
            <map from="${batchenrollment-gui.dist.dir}/" to=""/>
        </pathconvert>
        <jar destfile="${batchenrollment-gui.dist.dir}/batchenrollment-gui.jar" basedir="${batchenrollment-gui.build.dir}">
            <manifest>
                <attribute name="Class-path" value="${batchenrollment-gui.dependencies} ./" />
                <attribute name="Main-Class" value="org.ejbca.batchenrollmentgui.BatchEnrollmentGUIApp"/>
            </manifest>
            <zipfileset dir="${batchenrollment-gui.src.dir}" includes="log4j.properties"/>
            <zipfileset dir="${batchenrollment-gui.src.dir}" includes="META-INF/*"/>
            <zipfileset dir="${batchenrollment-gui.src.dir}" includes="org/ejbca/batchenrollmentgui/resources/**"/>
        </jar>
    </target>

    <target name="compile">
        <mkdir dir="${batchenrollment-gui.build.dir}" />
        <javac srcdir="${batchenrollment-gui.src.dir}" destdir="${batchenrollment-gui.build.dir}" debug="on" includeantruntime="no" encoding="UTF-8"
            target="${java.target.version}" classpathref="compile.classpath"/>
    </target>

</project>
