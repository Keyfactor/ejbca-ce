<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html 
	xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets" 
    xmlns:component="http://java.sun.com/jsf/composite/component" 
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:fn="http://java.sun.com/jsp/jstl/functions" 
    xmlns:t="http://myfaces.apache.org/tomahawk">
<ui:remove>
    <!--
    /*************************************************************************
     *                                                                       *
     *  EJBCA: The OpenSource Certificate Authority                          *
     *                                                                       *
     *  This software is free software; you can redistribute it and/or       *
     *  modify it under the terms of the GNU Lesser General Public           *
     *  License as published by the Free Software Foundation; either         *
     *  version 2.1 of the License, or any later version.                    *
     *                                                                       *
     *  See terms of license at gnu.org.                                     *
     *                                                                       *
     *************************************************************************/

     version: $Id$
     -->
</ui:remove>
<h:body dir="#{raLocaleBean.direction}" styleClass="#{raLocaleBean.direction}Direction">
    <ui:composition>
        <h:panelGroup layout="block" class="pure-g">
            <h:panelGroup id="div_menu_logo" layout="block" class="pure-u-1 pure-u-lg-1-8">
                   <h:panelGroup layout="block" class="pure-menu pure-menu-horizontal" >
                   <h:outputLink value="index.xhtml" styleClass="pure-menu-heading">
                        <img class="menu_logo" alt="EJBCA by PrimeKey" src="#{facesContext.externalContext.context.contextPath}/img/pk_logo.png" /> 
                   </h:outputLink>
                </h:panelGroup>
            </h:panelGroup>
            <h:panelGroup layout="block" class="pure-u-1 pure-u-md-1-2 pure-u-lg-13-24">
                <h:panelGroup layout="block" class="pure-menu pure-menu-horizontal">
                    <ul class="pure-menu-list">
                        <ui:fragment rendered="#{raAccessBean.authorizedToEnroll}">
                        <ui:remove><!-- BEGIN: show/hide menu items on tablet/phone --></ui:remove>
                        <h:selectBooleanCheckbox id="we-menu-open-close" class="web-express tablet"/>
        				<li id="menu-head-is-closed" class="web-express tablet">
	            			<label for="we-menu-open-close">
	                			<span></span>
	                			<span></span>
	                			<span></span>
	            			</label>
        				</li>
        				<li id="menu-head-is-open" class="web-express tablet">
	            			<label for="we-menu-open-close">
	                			<span></span>
	                			<span></span>
	            			</label>
        				</li>
				        <li id="menu-title" class="web-express tablet pure-menu-item"><span>Menu</span></li>
        				<hr class="web-express tablet"/>
                        <ui:remove><!-- END: show/hide menu items on tablet/phone --></ui:remove>
                        
                            <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                                <h:selectBooleanCheckbox id="web-express-enrollment" class="web-express tablet"/>
            					<label for="web-express-enrollment" class="web-express tablet">&nbsp;</label>
            					<a href="#" id="enrollment" class="pure-menu-link enroll-menu-link">Enroll</a>                            
                                <ul class="pure-menu-children">
                                    <ui:fragment rendered="#{raAccessBean.authorizedToEnrollMakeRequest}">
                                    	<li class="pure-menu-item">
                                            <h:outputLink value="enrollmakenewrequest.xhtml" styleClass="pure-menu-link enroll-menu-link"><h:outputText value="#{msg.menu_pagetitle_enroll_make_new_request}"/></h:outputLink>
                                        </li>
                                    </ui:fragment>
                                    <ui:fragment rendered="#{raAccessBean.authorizedToEnrollWithRequestId}">
                                        <li class="pure-menu-item">
                                        	<h:outputLink value="enrollwithrequestid.xhtml" styleClass="pure-menu-link enroll-menu-link"><h:outputText value="#{msg.menu_pagetitle_enroll_use_request_id}"/></h:outputLink>
                                        </li>
                                    </ui:fragment>
                                    <ui:fragment rendered="#{raAccessBean.authorizedToEnrollWithRequestId}">
                                        <li class="pure-menu-item">
                                        	<h:outputLink value="enrollwithusername.xhtml" styleClass="pure-menu-link enroll-menu-link"><h:outputText value="#{msg.menu_pagetitle_enroll_use_username}"/></h:outputLink>
                                        </li>
                                    </ui:fragment>
                                </ul>
                            </li>
                        </ui:fragment>
                        <ui:fragment rendered="#{raAccessBean.authorizedToSearch}">
                        	<li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                                <h:selectBooleanCheckbox id="web-express-search" class="web-express tablet"/>
            					<label for="web-express-search" class="web-express tablet">&nbsp;</label>
                                <a href="#" id="search" class="pure-menu-link search-menu-link">Search</a>
                               	<ul class="pure-menu-children">
                                   	<ui:fragment rendered="#{raAccessBean.authorizedToSearchCerts}">
                                       	<li class="pure-menu-item">
                                           	<h:outputLink value="search_certs.xhtml" styleClass="pure-menu-link search-menu-link">
                                           		<h:outputText value="#{msg.menu_pagetitle_search_certs}"/>
                                           	</h:outputLink>
                                      		</li>
                                   	</ui:fragment>
                                   	<ui:fragment rendered="#{raAccessBean.authorizedToSearchEndEntities}">
                                   		<li class="pure-menu-item">
                                    	    	<h:outputLink value="search_ees.xhtml" styleClass="pure-menu-link search-menu-link">
                                    	    		<h:outputText value="#{msg.menu_pagetitle_search_ees}"/>
                                    	    	</h:outputLink>
                                      		</li>
                                   	</ui:fragment>
                               	</ul>
                           	</li>
                       	</ui:fragment>
                        <ui:fragment rendered="#{raAccessBean.authorizedToManageRequests}">
                        	<li class="pure-menu-item">
                            	<h:outputLink value="managerequests.xhtml" styleClass="pure-menu-link requests-menu-link">
                            		<h:outputText value="#{msg.menu_pagetitle_manage_requests}"/>
                            	</h:outputLink>
                            </li>
                        </ui:fragment>
                        <ui:fragment rendered="#{raAccessBean.authorizedToCas}">
                            <li class="pure-menu-item">
                                <h:outputLink value="cas.xhtml" styleClass="pure-menu-link cas-menu-link"><h:outputText value="#{msg.menu_pagetitle_cas}"/></h:outputLink>
                            </li>
                        </ui:fragment>
                        
                        
                        <hr class="web-express tablet"/>
                        <ui:remove>
                        <!-- Language change is enabled, but there are no translations yet and left-to-right is not
                             fully supported, so we disable it until lwe have some actual traslations -->
                    	<li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
				            <h:selectBooleanCheckbox id="web-express-language" class="web-express tablet" type="checkbox"/>
            				<label for="web-express-language" class="web-express tablet">&nbsp;</label>
                        	<a href="#" id="language" class="pure-menu-link">Language</a>
                        	<ul class="pure-menu-children">
                        		<h:form>
	                        		<ui:repeat value="#{raLocaleBean.supportedLocales}" var="supportedLocale">
	                        			<li class="pure-menu-item">
	                        				<h:commandButton action="#{raLocaleBean.setLocale(supportedLocale)}" label="#{supportedLocale.language}" 
	                        					value="#{supportedLocale.getDisplayLanguage(supportedLocale)}" styleClass="pure-menu-item language_button"/> 
	                        			</li>         			
	                        		</ui:repeat>
                        		</h:form>
                        	</ul>
                        </li>
                        </ui:remove>
                        <ui:fragment rendered="#{raAccessBean.authorizedToRoles}">
                            <li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
                                <h:selectBooleanCheckbox id="web-express-roles" class="web-express tablet"/>
                                <label for="web-express-roles" class="web-express tablet">&nbsp;</label>
                                <a href="#" id="roles" class="pure-menu-link roles-menu-link">#{msg.menu_pagetitle_role_management}</a>
                                <ul class="pure-menu-children">
                                    <ui:fragment rendered="#{raAccessBean.authorizedToRoleRules}">
                                        <li class="pure-menu-item">
                                            <h:outputLink value="roles.xhtml" styleClass="pure-menu-link role-menu-link">
                                                <h:outputText value="#{msg.menu_pagetitle_roles}"/>
                                            </h:outputLink>
                                            </li>
                                    </ui:fragment>
                                    <ui:fragment rendered="#{raAccessBean.authorizedToRoleMembers}">
                                        <li class="pure-menu-item">
                                                <h:outputLink value="role_members.xhtml" styleClass="pure-menu-link role-menu-link">
                                                    <h:outputText value="#{msg.menu_pagetitle_role_members}"/>
                                                </h:outputLink>
                                            </li>
                                    </ui:fragment>
                                </ul>
                            </li>
                        </ui:fragment>

                        <ui:fragment rendered="#{raAccessBean.authorizedToCas}">
                            <li class="pure-menu-item">
                            <h:outputLink
                                    value="preferences.xhtml"
                                    styleClass="pure-menu-link role-menu-link">
                                    <h:outputText value="#{msg.menu_pagetitle_preferences}" />
                            </h:outputLink>
                            </li>
                            <!-- This function is used to force a page reload after applying the custom admin preferences.
                                 This way the changes will take effect without the need for user to press Ctrl+F5. -->
                            <script type="text/javascript">
                                        window.onload = function() {
                                            if ((window.location.pathname === '/ejbca/ra/') ||
                                            	(window.location.href.indexOf("preferences.xhtml") > -1)) {
                                                if (!window.location.hash) {
                                                window.location = window.location + '#loaded';
                                                window.location.reload(true)
                                                }
                                            }
                                        }
                            </script>  
                        </ui:fragment>

						<ui:remove>
                        <!-- Not yet implemented for 6.6.0, but put here as a placeholder. 
                        <li class="pure-menu-item pure-menu-allow-hover"><h:outputLink value="#" styleClass="pure-menu-link"><h:outputText value="#{msg.menu_pagetitle_documentation}"/></h:outputLink></li>
                        -->
                        </ui:remove>
                        <ui:remove>
                        <!-- This could be implemented as a link to a different URL (with the default settings it would be https://hostname:8443/ejbca/ra/ ).
                             But I don't think everyone will want to have a "Log in" link here, since it could confuse public users.
                        <ui:fragment rendered="#{raAuthenticationBean.publicUser}">
                            <li class="pure-menu-item"><h:outputLink value="#" styleClass="pure-menu-link"><h:outputText value="#{msg.menu_pagetitle_login}"/></h:outputLink></li>
                        </ui:fragment>
                        -->
                        </ui:remove>
                        <ui:remove>
                        <!-- 
                            Log out is not implemented for administrators using certificate login. This is highly depending on the browser 
                        -->
                        </ui:remove>
                        <ui:fragment rendered="#{!raAuthenticationBean.publicUser}">
                            <li class="pure-menu-item"><h:outputLink value="#" styleClass="pure-menu-link"><h:outputText value="#{msg.menu_pagetitle_logout} #{raAuthenticationBean.userDisplayName}"/></h:outputLink></li>
                        </ui:fragment>
                    </ul>
                </h:panelGroup>
            </h:panelGroup>
            <h:panelGroup layout="block" styleClass="pure-u-1 pure-u-lg-1-3"></h:panelGroup>
        </h:panelGroup>
    </ui:composition>
</h:body>
</html>