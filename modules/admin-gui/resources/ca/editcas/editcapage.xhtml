<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:t="http://myfaces.apache.org/tomahawk"
	xmlns:c="http://xmlns.jcp.org/jsp/jstl/core">
<ui:remove>
	<!--
	/*************************************************************************
	*                                                                       *
	*  EJBCA: The OpenSource Certificate Authority                          *
	*                                                                       *
	*  This software is free software; you can redistribute it and/or       *
	*  modify it under the terms of the GNU Lesser General Public           *
	*  License as published by the Free Software Foundation; either         *
	*  version 2.1 of the License, or any later version.                    *
	*                                                                       *
	*  See terms of license at gnu.org.                                     *
	*                                                                       *
	*************************************************************************/

	$Id$
	-->
</ui:remove>

<ui:composition template="/WEB-INF/include/template.xhtml">
    <ui:param name="resourceBean" value="#{editCAsMBean}" />

	<ui:define name="content">
		<h2>
			<h:outputText value="#{editCAsMBean.editCAPageTitle}" />
		</h2>
		<h3>
			<h:outputText value="#{web.text.CANAME}" />
			<h:outputText value="#{editCAsMBean.editCaName}"
				rendered="#{editCAsMBean.editCA}" />
			<h:outputText value="#{editCAsMBean.createCaNameTitle}"
				rendered="#{not editCAsMBean.editCA}" />
		</h3>

		<h:form id="editcapage" enctype="multipart/form-data">
			<h:panelGrid columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row0,Row1"
				columnClasses="editColumn1,editColumn2">
				<h:panelGroup>
						&nbsp;
					</h:panelGroup>

				<h:outputLink value="managecas.xhtml">
					<h:outputText value="#{web.text.BACKTOCAS}" />
				</h:outputLink>

				<h:panelGroup>
					<h:outputLabel for="getcaid" value="#{web.text.CAID}"
						rendered="#{editCAsMBean.editCA}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:outputText id="getcaid" value="#{editCAsMBean.caid}"
						rendered="#{editCAsMBean.editCA}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="getcatype" value="#{web.text.CATYPE}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/Certificate_Authority_Overview.html#CA_Types')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup id="changecatype"
					rendered="#{not editCAsMBean.editCA}">
					<h:commandButton
						id="catypex509"
						styleClass="selectButton largeSelectButton #{editCAsMBean.caInfoDto.caTypeX509?'selected':'notSelected'}"
						action="#{editCAsMBean.setCaTypeX509}"
						value="#{editCAsMBean.caInfoDto.caTypeX509?'✓':' '}#{web.text.X509}">
						<f:ajax listener="#{editCAsMBean.resetSignedBy()}" render="@form" />
					</h:commandButton>
					<h:commandButton
						id="catypecvc"
						styleClass="selectButton largeSelectButton #{editCAsMBean.caTypeCVC?'selected':''}"
						action="#{editCAsMBean.setCaTypeCVC}"
						value="#{editCAsMBean.caTypeCVC?'✓':' '}#{web.text.CVCCA}">
						<f:ajax listener="#{editCAsMBean.resetSignedBy()}" render="@form" />
					</h:commandButton>
					<h:commandButton
						id="catypessh"
						styleClass="selectButton largeSelectButton #{editCAsMBean.caTypeSSH?'selected':''}"
						action="#{editCAsMBean.setCaTypeSSH}"
						value="#{editCAsMBean.caTypeSSH?'✓':' '}#{web.text.SSHCA}"
						rendered="#{editCAsMBean.renderSshAvailable}">
						<f:ajax listener="#{editCAsMBean.resetSignedBy()}" render="@form" />
					</h:commandButton>
					<h:commandButton
						id="catypecits"
						styleClass="selectButton largeSelectButton #{editCAsMBean.caTypeCits?'selected':''}"
						action="#{editCAsMBean.setCaTypeCits}"
						value="#{editCAsMBean.caTypeCits?'✓':' '}#{web.text.CITS_CA}"
						rendered="#{editCAsMBean.renderCitsAvailable}">
						<f:ajax listener="#{editCAsMBean.renderCitsFields()}" render="@form" />
					</h:commandButton>
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.editCA}">
					<h:outputText id="getcatype" value="#{editCAsMBean.currentCaType}" />
				</h:panelGroup>

				<!-- "IF CVC NOT AVAILABLE"  -->
				<h:panelGroup rendered="#{editCAsMBean.renderCvcAvailable}" />
				<h:panelGroup rendered="#{editCAsMBean.renderCvcAvailable}">
					<h:outputText value="#{web.text.CVCCANOTAVAILABLE}"
						rendered="#{not editCAsMBean.cvcAvailable}" />
					<h:outputText value="#{web.text.CVCCANOTAVAILABLEUNIQUEINDEX}"
						rendered="#{editCAsMBean.cvcAvailable}" />
				</h:panelGroup>

				<!-- "IF CVC AVAILABLE"  -->
				<c:if test="#{not editCAsMBean.caTypeProxy}">
				<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable and not editCAsMBean.caTypeProxy}">
					<h:outputLabel value="#{web.text.CRYPTOTOKEN}"
								   style="font-weight: bold;" />
					<h:outputText
							value="#{web.ejbcaWebBean.getHelpReference('/Managing_Crypto_Tokens.html')}"
							escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup
						rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable}">
					<h:outputLink value="#{editCAsMBean.currentCaCryptoTokenLink}"
								  rendered="#{editCAsMBean.currentCaCryptoTokenPresent}">
						<h:outputText value="#{editCAsMBean.currentCaCryptoTokenName}" />
					</h:outputLink>
					<h:outputText value="#{editCAsMBean.currentCaCryptoTokenName}"
								  rendered="#{not editCAsMBean.currentCaCryptoTokenPresent}" />
				</h:panelGroup>

				<h:panelGroup
						rendered="#{not editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable and not editCAsMBean.caTypeProxy}">
					<h:outputText value="#{web.text.CRYPTOTOKEN_NOSUITABLE}"
								  rendered="#{not editCAsMBean.cryptoTokenSuitable}" />
					<h:selectOneMenu name="selectcryptotoken"
									 id="selectcryptotoken"
									 rendered="#{editCAsMBean.cryptoTokenSuitable}"
									 value="#{editCAsMBean.cryptoTokenIdParam}">
						<f:selectItems value="#{editCAsMBean.availableCryptoTokenList}" />
						<f:ajax listener="#{editCAsMBean.resetSigningAlgorithmTokenParam()}" render="@form"/>
					</h:selectOneMenu>
					<br />

					<h:panelGroup style="overflow-y: auto; width: 500px; height: auto; max-height:75px; margin-bottom: 5px; margin-top: 5px"
								  layout="block">
						<ui:repeat value="#{editCAsMBean.selectedCryptoTokenInfo}" var="info">
							<h:outputLabel styleClass="help" value="#{info}" /> <br/>
						</ui:repeat>
					</h:panelGroup>

					<h:outputLabel value="#{web.text.CRYPTOTOKEN_NEED_EXISTING_OR_GEN}"
								   style="font-weight: bold;"
								   rendered="#{not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.cryptoTokenNeedExistingOrGen}" />
					<h:outputLabel
							value="You need to select a Crypto Token that exists, or generate keys if it exists, before you can initialize!"
							style="font-weight: bold;"
							rendered="#{not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.cryptoTokenIdParamNull}" />
				</h:panelGroup>

				<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.failedCryptoTokenExist}">
					<h:outputLabel value="Failed to access these CryptoTokens:"
								   style="font-weight: bold;" />
                </h:panelGroup>
                <h:panelGroup
                        rendered="#{not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.failedCryptoTokenExist}">
                    <h:outputLabel value="Failed to access these CryptoTokens:"
                                   style="font-weight: bold;" />
                </h:panelGroup>
                <h:panelGroup
                        rendered="#{not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.failedCryptoTokenExist}">
                    <ui:repeat var="failedCrypto"
                               value="#{editCAsMBean.failedCryptoTokenNames}">
                        <h:outputText value="#{failedCrypto}" /> <br/>
                    </ui:repeat>
                </h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable}">
					<h:outputLabel for="getsigningalgorithm"
						value="#{web.text.SIGNINGALGORITHM}" style="font-weight: bold;" />
				</h:panelGroup>
				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable}">
					<h:outputText id="getsigningalgorithm"
						value="#{editCAsMBean.currentCaSigningAlgorithm}"
						rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized and not editCAsMBean.caExternal}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{not editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable}">
					<h:outputLabel value="#{web.text.SIGNINGALGORITHM}"
						style="font-weight: bold;" />
				</h:panelGroup>
				<h:panelGroup
					rendered="#{not editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable}">
					<h:selectOneMenu name="#{web.text.SELECT_SIGNATUREALGORITHM}"
						value="#{editCAsMBean.signatureAlgorithmParam}">
						<f:selectItems value="#{editCAsMBean.availableSigningAlgList}" />
						<f:ajax event="change" render="editcapage" />
					</h:selectOneMenu>
					<br/>
					<h:outputLabel styleClass="smallHelp" value="#{web.text.SIGNINGALGORITHM_FILTERED}" />
				</h:panelGroup>

				<!-- Edit CA -->
				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.currentCaCryptoTokenPresent}">
					<h:outputLabel for="defaultKey" value="#{editCAsMBean.caTypeCits ? 'encryptionKey' : 'defaultKey'}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.currentCaCryptoTokenPresent}">
					<h:outputText id="defaultKey"
						value="#{editCAsMBean.currentCaCryptoTokenDefaultKey}"
						rendered="#{editCAsMBean.currentCaCryptoTokenPresent}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.currentCaCryptoTokenPresent}">
					<h:outputLabel for="certSignKey" value="certSignKey" />
				</h:panelGroup>
				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.currentCaCryptoTokenPresent}">
					<h:outputText id="certSignKey"
						value="#{editCAsMBean.currentCaCryptoTokenCertSignKey}"
						rendered="#{editCAsMBean.currentCaCryptoTokenPresent}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable 
									and editCAsMBean.currentCaCryptoTokenPresent and not editCAsMBean.caTypeCits}">
					<h:outputLabel for="crlSignKey" value="crlSignKey" />
				</h:panelGroup>
				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable 
									and editCAsMBean.currentCaCryptoTokenPresent and not editCAsMBean.caTypeCits}">
					<h:outputText id="crlSignKey"
						value="#{editCAsMBean.currentCaCryptoTokenCrlSignKey}"
						rendered="#{editCAsMBean.currentCaCryptoTokenPresent}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable 
									and editCAsMBean.currentCaCryptoTokenPresent and not editCAsMBean.caTypeCits}">
					<h:outputLabel for="keyEncryptKey" value="keyEncryptKey" />
				</h:panelGroup>
				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable 
									and editCAsMBean.currentCaCryptoTokenPresent and not editCAsMBean.caTypeCits}">
					<h:outputText id="keyEncryptKey"
						value="#{editCAsMBean.currentCaCryptoTokenKeyEncryptKey}"
						rendered="#{editCAsMBean.currentCaCryptoTokenPresent}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.currentCaCryptoTokenPresent}">
					<h:outputLabel for="testKey" value="testKey" />
				</h:panelGroup>
				<h:panelGroup
					rendered="#{editCAsMBean.editCANotUninitializedNotExternal and not editCAsMBean.renderCvcAvailable and editCAsMBean.currentCaCryptoTokenPresent}">
					<h:outputText id="testKey"
						value="#{editCAsMBean.currentCaCryptoTokenTestKey}"
						rendered="#{editCAsMBean.currentCaCryptoTokenPresent}" />
				</h:panelGroup>


				<!-- Create CA -->
				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable}">
					<h:outputText value="#{editCAsMBean.caTypeCits ? 'encryptionKey' : 'defaultKey'}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable}">
					<h:selectOneMenu id="selectDefaultKey"
						value="#{editCAsMBean.selectedCryptoTokenDefaultKey}">
						<f:selectItems value="#{editCAsMBean.getKeyAliasesList('defaultKey')}" />
					</h:selectOneMenu>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable}">
					<h:outputText value="certSignKey" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable}">
					<h:selectOneMenu
						value="#{editCAsMBean.selectedCryptoTokenCertSignKey}">
						<f:selectItems value="#{editCAsMBean.getKeyAliasesList('certSignKey')}" />
					</h:selectOneMenu>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable
									and not editCAsMBean.caTypeCits}">
					<h:outputText value="crlSignKey" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable
									and not editCAsMBean.caTypeCits}">
					<h:outputText value="#{web.text.CRYPTOTOKEN_USECERTSIGN}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable
									and not editCAsMBean.caTypeCits}">
					<h:outputText value="keyEncryptKey" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable
									and not editCAsMBean.caTypeCits}">
					<h:selectOneMenu value="#{editCAsMBean.selectedKeyEncryptKey}">
						<f:selectItems
							value="#{editCAsMBean.getKeyAliasesListWithDefault('keyEncryptKey')}" />
					</h:selectOneMenu>
					<br />

					<h:panelGroup style="overflow-y: auto; width: 500px; height: auto; max-height:75px; margin-bottom: 5px; margin-top: 5px"
								  layout="block">
						<h:outputLabel styleClass="help" value="#{web.text.KEY_ENCRYPT_KEY_RESTRICTIONS}" />		
					</h:panelGroup>
					
					
					
				</h:panelGroup>


				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable}">
					<h:outputText value="testKey" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.renderCreateCaTokenKeys and not editCAsMBean.renderCvcAvailable}">
					<h:selectOneMenu name="selectkeytestkey"
						value="#{editCAsMBean.selectTestKey}">
						<f:selectItems value="#{editCAsMBean.getKeyAliasesListWithDefault('testKey')}" />
					</h:selectOneMenu>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{not editCAsMBean.editCA or editCAsMBean.currentCaCryptoTokenPresent and not editCAsMBean.renderCvcAvailable}">
					<h:outputLabel for="keysequenceformat"
						value="#{web.text.KEYSEQUENCEFORMAT}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Key_Sequence_Format')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup
					rendered="#{not editCAsMBean.editCA or editCAsMBean.currentCaCryptoTokenPresent and not editCAsMBean.renderCvcAvailable}">
					<h:selectOneMenu id="keysequenceformat"
						value="#{editCAsMBean.caInfoDto.keySequenceFormat}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:selectItems value="#{editCAsMBean.keySequenceFormatList}"/>
					</h:selectOneMenu>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{not editCAsMBean.editCA or editCAsMBean.currentCaCryptoTokenPresent and not editCAsMBean.renderCvcAvailable}">
					<h:outputLabel for="keysequence" value="#{web.text.KEYSEQUENCE}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Key_Sequence')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup
					rendered="#{not editCAsMBean.editCA or editCAsMBean.currentCaCryptoTokenPresent and not editCAsMBean.renderCvcAvailable}">
					<h:inputText id="keysequence" size="6" maxlength="10"
						value="#{editCAsMBean.keySequence}"
						disabled="#{not editCAsMBean.hasEditRight}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.renderCvcAvailable}">
					<h:outputLabel for="description" value="#{web.text.DESCRIPTION}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.renderCvcAvailable}">
					<h:outputText id="description" value="#{editCAsMBean.caInfoDto.description}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputTextarea name="#{web.text.TEXTFIELD_DESCRIPTION}" cols="45"
						rows="2" value="#{editCAsMBean.caInfoDto.description}"
						disabled="#{not editCAsMBean.hasEditRight}"
						rendered="#{not editCAsMBean.caExternal}" />
				</h:panelGroup>
			  </c:if>
				
			</h:panelGrid>
			
			<!-- ==================================================================== CITS Attributes =================================================================================== -->
			<h:panelGrid columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row0,Row1"
				columnClasses="editColumn1,editColumn2"
				rendered="#{editCAsMBean.caTypeCits}">
				<h:outputLabel for="header_cits_attributes"
					value="#{web.text.CITS_ATTRIBUTES}" style="font-weight: bold;" />
				<h:panelGroup id="header_cits_attributes" />
				
				<h:panelGroup>
					<h:outputLabel for="textfieldcertificateid"
						value="#{web.text.CITS_CERTIFICATE_ID}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#CITS_CERTIFICATE_ID')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:outputText value="#{editCAsMBean.caInfoDto.certificateId}"
						rendered="#{editCAsMBean.editCA}" />
					<h:inputText size="20" maxlength="255"
						id="textfieldcertificateid" styleClass="mandatory"
						value="#{editCAsMBean.caInfoDto.certificateId}"
						required="true"
						rendered="#{not editCAsMBean.editCA}" 
						disabled="#{not editCAsMBean.editCA and not editCAsMBean.hasEditRight}" >
					</h:inputText>	
					<br />	
					<h:outputText styleClass="help"
						value="#{web.text.CITS_CERTIFICATE_ID_HELP}" style="margin-left: 3px;"/> 
				</h:panelGroup>
				
				<h:panelGroup>
					<h:outputLabel 
						value="#{web.text.CERTIFICATEPROFILE}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputText name="selectcitscertificateprofile"
						value="#{editCAsMBean.certificateProfileEditCAUninitialized}"
						rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized}" />
					<h:selectOneMenu id="selectcitscertificateprofile"
						value="#{editCAsMBean.caInfoDto.currentCertProfile}"
						rendered="#{editCAsMBean.renderSelectCertificateProfile}"
						disabled="#{!editCAsMBean.hasEditRight and !editCAsMBean.caUninitialized}">
						<f:selectItems value="#{editCAsMBean.certificateProfiles}" />
					</h:selectOneMenu>
				</h:panelGroup>
				
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputLabel value="#{web.text.CERT_VALIDITY}"
						style="font-weight: bold;" />
					<h:outputLabel
						value="#{web.text.CITS_VALIDITY}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/Certificate_Profile_Fields.html#validity')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:inputText name="textfieldcitsvalidity" id="textfieldcitsvalidity"
						size="25" maxlength="225"
						value="#{editCAsMBean.caEncodedValidity}"
						title="#{web.text.CITS_VALIDITY_HELP}"
						label="Cits Ca Validity" styleClass="mandatory"
						required="true" 
						disabled="#{!editCAsMBean.hasEditRight and !editCAsMBean.caUninitialized}">
					</h:inputText>	
					<br />	
					<h:outputText styleClass="help"
						value="#{web.text.CITS_VALIDITY_HELP}" style="margin-left: 3px;"/> 
					<h:outputText styleClass="help" rendered="#{editCAsMBean.editCA}"
						value="#{web.text.CERT_VALIDITY_CA_HELP}" style="margin-left: 3px;"/> 
				</h:panelGroup>
				
				<h:panelGroup>
					<h:outputLabel for="citsexpirytime" rendered="#{editCAsMBean.editCA}"
						value="#{web.text.CITS_CA_EXPIRY_TIME}" />
				</h:panelGroup>
				
				<h:panelGroup>
					<h:outputText id="citsexpirytime" value="#{editCAsMBean.expiryTime}"
													rendered="#{editCAsMBean.editCA}" />
				</h:panelGroup>
				
				<h:panelGroup>
					<h:outputLabel for="citshexencodedcert" rendered="#{editCAsMBean.editCA}"
						value="#{web.text.CITS_CA_HEX_ENCODED_CERT}" />
				</h:panelGroup>
				
				<h:panelGroup>
					<h:outputText id="citshexencodedcert" value="#{editCAsMBean.citsHexCertificate}"
										escape="false"	rendered="#{editCAsMBean.editCA}" />
				</h:panelGroup>
				
				<h:panelGroup>
					<h:outputLabel for="citshexencodedcerthash" rendered="#{editCAsMBean.editCA}"
						value="#{web.text.CITS_CA_HEX_ENCODED_CERT_HASH}" />
				</h:panelGroup>
				
				<h:panelGroup>
					<h:outputText id="citshexencodedcerthash" value="#{editCAsMBean.citsHexCertificateHash}"
													rendered="#{editCAsMBean.editCA}" />
				</h:panelGroup>
				
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputLabel for="citscheckboxuseuserstorage"
						value="#{web.text.USEUSERSTORAGE}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Use_User_Storage')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectBooleanCheckbox id="citscheckboxuseuserstorage"
						value="#{editCAsMBean.caInfoDto.useUserStorage}"
						disabled="#{not editCAsMBean.hasEditRight}" >
					</h:selectBooleanCheckbox> 
					<h:outputLabel for="checkboxuseuserstorage" value="#{web.text.USE}" />
				</h:panelGroup>
				
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputLabel for="citscheckboxusecertificatestorage"
						value="#{web.text.USECERTIFICATESTORAGE}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Use_User_Storage')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectBooleanCheckbox id="citscheckboxusecertificatestorage"
						value="#{editCAsMBean.caInfoDto.useCertificateStorage}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:ajax render="citsnonExistingCertRevokeSection" immediate="true" event="change"/>
					</h:selectBooleanCheckbox>
					<h:outputLabel for="citscheckboxusecertificatestorage"
						value="#{editCAsMBean.checkboxUseCollapsedText}" />
				</h:panelGroup>
				
			</h:panelGrid>
				
			<h:panelGrid id="citsnonExistingCertRevokeSection" columns="2" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row1,Row0" 
				rendered="#{editCAsMBean.caTypeCits}"
				columnClasses="editColumn1,editColumn2">
				
				<h:panelGroup 
					rendered="#{editCAsMBean.caTypeCits and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:outputLabel
						value="#{web.text.ACCEPTREVOCATIONSNONEXISTINGENTRY}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Accept_Revocations_of_Non-Existing_Entries')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.caTypeCits and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:selectBooleanCheckbox
						id="citscheckboxacceptrevocationsnonexistingentry"
						value="#{editCAsMBean.caInfoDto.acceptRevocationsNonExistingEntry}"
						disabled="#{editCAsMBean.checkboxAcceptRevocationsNonExistingEntryDisabled}">
						<f:ajax
							render="citsselectdefaultcertificateprofile citscheckboxuseappendonlytable" />
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxacceptrevocationsnonexistingentry"
						value="#{web.text.ACCEPT}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caTypeCits and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:outputLabel value="#{web.text.CERTIFICATEPROFILEFORNONEXISTING}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Default_Certificate_Profile_for_Non-Existing_Entries')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caTypeCits and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:selectOneMenu id="citsselectdefaultcertificateprofile"
						value="#{editCAsMBean.caInfoDto.defaultCertificateProfile}"
						disabled="#{editCAsMBean.certificateProfileForNonExistingDisabled}">
						<f:selectItems value="#{editCAsMBean.throwAwayDefaultProfileList}" />
					</h:selectOneMenu>
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caTypeCits and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:outputLabel value="#{web.text.USEAPPENDONLYTABLE}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Use_Append-Only_Table')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caTypeCits and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:selectBooleanCheckbox id="citscheckboxuseappendonlytable"
						value="#{editCAsMBean.caInfoDto.useNoConflictCertificateData}"
						disabled="#{editCAsMBean.certificateProfileForNonExistingDisabled}">
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxuseappendonlytable"
						value="#{web.text.USE}" />
				</h:panelGroup>
				
           	</h:panelGrid>	
           	
           	<h:panelGrid id="addgeographicregion" columns="3" cellspacing="3" 
				cellpadding="3" border="0" width="100%" rowClasses="Row1,Row0" 
				rendered="#{editCAsMBean.caTypeCits}"
				columnClasses="editColumn1,editColumn2">
				
				 <h:outputText style="font-weight: bold;" 
                    value="#{web.text.SELECT_CITS_GEOGRAPHIC_REGION}" />
                
                <h:panelGrid id="geographicregiongrid" columns="4">
                    <h:selectOneMenu id="geographicRegionType"
                        value="#{editCAsMBean.currentGeographicRegionType}"
                        disabled="#{not empty editCAsMBean.geographicRegions}">
                        <f:ajax />
                        <!-- Needed to submit the selected item via AJAX -->
                        <f:selectItems id="geoRegionTypesList"
                            value="#{editCAsMBean.geographicRegionTypes}" />
                    </h:selectOneMenu>
                    <h:commandButton id="addGeographicRegion"
                        value="#{web.text.ADD}"
                        action="#{editCAsMBean.addGeographicRegion()}"
                        rendered="#{not editCAsMBean.caExternal}">
                        <f:ajax onerror="function(data){ejbca.adminweb.showAlertOnError(data);}"
                            render="geographicRegionType geographicregions " />
                    </h:commandButton>
	                 <h:commandButton id="updateGeographicRegions"
	                        value="#{web.text.PREVIEW_REMOVE_SELECTED}"
	                        action="#{editCAsMBean.updateGeographicRegions()}"
	                        rendered="#{not editCAsMBean.caExternal}">
	                        <f:ajax render="geographicRegionType geographicregions" />
	                 </h:commandButton>
                </h:panelGrid>
			</h:panelGrid>
			
			<h:dataTable id="geographicregions" var="geoRegion" 
                value="#{editCAsMBean.geographicRegions}"
                cellspacing="1" cellpadding="3" border="0" width="100%"
                rowClasses="Row0,Row1"
                columnClasses="editColumn1,editColumn2">
                
                <h:column>
	                    <h:outputLabel for="georegiondescription"
	                        value="#{geoRegion.name}" 
	                        rendered="#{empty geoRegion.previewText}"/> <br/>
	                    <h:outputText id="georegionpreview"
                            value="#{geoRegion.previewText}" escape="false">
                        </h:outputText> <br/>
                        <h:selectBooleanCheckbox 
							value="#{geoRegion.toRemove}"
							disabled="#{not editCAsMBean.hasEditRight}" >
							<f:ajax />
						</h:selectBooleanCheckbox>
						<h:outputLabel value="#{web.text.REMOVE}" /> 
                </h:column>
                <h:column>
                	<h:panelGrid id="georegiondescriptionGrid" columns="3">
	                    <h:selectOneMenu id="geographicregioncountry"
	                        value="#{geoRegion.country}"
	                        rendered="#{not empty geoRegion.validOptions}">
	                        <f:ajax />
	                        <!-- Needed to submit the selected item via AJAX -->
	                        <f:selectItems id="georegionidentites"
	                            value="#{geoRegion.validOptions}" />
	                    </h:selectOneMenu>
	                    <h:inputText id="georegiondescription"
                            value="#{geoRegion.description}" size="45"
                            maxlength="512">
                            <f:ajax />
                        </h:inputText>
                    </h:panelGrid>
                    <h:outputText styleClass="help" value="#{geoRegion.helpText}" />
                </h:column>
            </h:dataTable>
				
			
			<!-- ==================================================================== CITS Attributes =================================================================================== -->

			<!-- ==================================================================== Directives =================================================================================== -->

			<h:panelGrid columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row0,Row1"
				columnClasses="editColumn1,editColumn2"
				rendered="#{not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable
								and not editCAsMBean.caTypeCits and not editCAsMBean.caTypeProxy}">
				<h:outputLabel for="header_directives"
					value="#{web.text.DIRECTIVES}" style="font-weight: bold;" />
				<h:panelGroup id="header_directives" />

				<h:panelGroup>
					<h:outputLabel for="isdoenforceuniquepublickeys"
						value="#{web.text.DOENFORCEUNIQUEPUBLICKEYS}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Enforce_unique_public_keys')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:selectBooleanCheckbox id="isdoenforceuniquepublickeys"
						value="#{editCAsMBean.caInfoDto.doEnforceUniquePublickeys}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:outputLabel for="isdoenforceuniquepublickeys"
						value="#{web.text.ENFORCE}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="isdoenforcekeyrenewal"
						value="#{web.text.DOENFORCEKEYRENEWAL}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Enforce_key_renewal')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:selectBooleanCheckbox id="isdoenforcekeyrenewal"
						value="#{editCAsMBean.caInfoDto.doEnforceKeyRenewal}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:outputLabel for="isdoenforcekeyrenewal"
						value="#{web.text.ENFORCE}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="isdoenforceuniquedn"
						value="#{web.text.DOENFORCEUNIQUEDN}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Enforce_unique_DN')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup>
					<h:selectBooleanCheckbox id="isdoenforceuniquedn"
						value="#{editCAsMBean.caInfoDto.doEnforceUniqueDN}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:outputLabel for="isdoenforceuniquedn"
						value="#{web.text.ENFORCE}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="doenforceuniquesubjectdnerialnumber"
						value="#{web.text.DOENFORCEUNIQUESUBJECTDNSERIALNUMBER}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Enforce_Unique_Subject_DN_SerialNumber')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup>
					<h:selectBooleanCheckbox id="doenforceuniquesubjectdnerialnumber"
						value="#{editCAsMBean.caInfoDto.doEnforceUniqueSubjectDNSerialnumber}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:outputLabel for="doenforceuniquesubjectdnerialnumber"
						value="#{web.text.ENFORCE}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="checkboxusecertreqhistory"
						value="#{web.text.USECERTREQHISTORY}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Use_Certificate_Request_History')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup>
					<h:selectBooleanCheckbox id="checkboxusecertreqhistory"
						value="#{editCAsMBean.caInfoDto.useCertReqHistory}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:outputLabel for="checkboxusecertreqhistory"
						value="#{web.text.USE}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="checkboxuseuserstorage"
						value="#{web.text.USEUSERSTORAGE}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Use_User_Storage')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup>
					<h:selectBooleanCheckbox id="checkboxuseuserstorage"
						value="#{editCAsMBean.caInfoDto.useUserStorage}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:outputLabel for="checkboxuseuserstorage" value="#{web.text.USE}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="checkboxusecertificatestorage"
						value="#{web.text.USECERTIFICATESTORAGE}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Use_User_Storage')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup>
					<h:selectBooleanCheckbox id="checkboxusecertificatestorage"
						value="#{editCAsMBean.caInfoDto.useCertificateStorage}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:ajax render="nonExistingCertRevokeSection" immediate="true" event="change"/>
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxusecertificatestorage"
						value="#{editCAsMBean.checkboxUseCollapsedText}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509 and editCAsMBean.renderOcspPreProduction}">
					<h:outputLabel for="checkboxpreproduceocspresponses"
						value="#{web.text.PREPRODUCEOCSPRESPONSES}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Pre_Produce_Ocsp_Responses')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509 and editCAsMBean.renderOcspPreProduction}">
					<h:selectBooleanCheckbox id="checkboxpreproduceocspresponses"
						value="#{editCAsMBean.caInfoDto.doPreProduceOcspResponses}"
						disabled="#{not editCAsMBean.hasEditRight}">
 						<f:ajax render="doStoreOnDemandSection" immediate="true"/>
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxpreproduceocspresponses" value="#{editCAsMBean.checkboxUseCollapsedText}" />
				</h:panelGroup>
				
	        </h:panelGrid>
	        
	        <h:panelGrid columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row0,Row1"
				columnClasses="editColumn1,editColumn2"
				rendered="#{editCAsMBean.caExternal}">
				<h:outputLabel for="header_directives_ext"
					value="#{web.text.DIRECTIVES}" style="font-weight: bold;" />
				<h:panelGroup id="header_directives_ext" />
				
				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509 and editCAsMBean.renderOcspPreProduction}">
					<h:outputLabel for="checkboxpreproduceocspresponsesext"
						value="#{web.text.PREPRODUCEOCSPRESPONSES}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509 and editCAsMBean.renderOcspPreProduction}">
					<h:selectBooleanCheckbox id="checkboxpreproduceocspresponsesext"
						value="#{editCAsMBean.caInfoDto.doPreProduceOcspResponses}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:ajax render="doStoreOnDemandSection" immediate="true"/>
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxpreproduceocspresponsesext" value="#{editCAsMBean.checkboxUseCollapsedText}" />
				</h:panelGroup>
			</h:panelGrid>
			
			<h:panelGrid id="doStoreOnDemandSection" columns="2" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row1,Row0"
				columnClasses="editColumn1,editColumn2">
				
				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.doPreProduceOcspResponses and editCAsMBean.caInfoDto.caTypeX509 and editCAsMBean.renderOcspPreProduction}">
					<h:outputLabel for="checkboxocspstoreondemand" value="#{web.text.PREPRODUCEONDEMAND}" />
						<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Store_Responses_On_Demand')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.doPreProduceOcspResponses and editCAsMBean.caInfoDto.caTypeX509 and editCAsMBean.renderOcspPreProduction}">
					<h:selectBooleanCheckbox id="checkboxocspstoreondemand"
						value="#{editCAsMBean.caInfoDto.doStoreOcspResponsesOnDemand}" 
						disabled="#{not editCAsMBean.hasEditRight}"/>
					<h:outputLabel for="checkboxocspstoreondemand" value="#{web.text.USE}" />
					<br/>
					<h:outputText styleClass="smallHelp" value="#{web.text.PREPRODUCEONDEMAND_HELP}"/>
				</h:panelGroup>
			</h:panelGrid>

            <h:panelGrid id="nonExistingCertRevokeSection" columns="2" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row1,Row0"
				columnClasses="editColumn1,editColumn2">
				<h:panelGroup
					rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:outputLabel
						value="#{web.text.ACCEPTREVOCATIONSNONEXISTINGENTRY}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Accept_Revocations_of_Non-Existing_Entries')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:selectBooleanCheckbox
						id="checkboxacceptrevocationsnonexistingentry"
						value="#{editCAsMBean.caInfoDto.acceptRevocationsNonExistingEntry}"
						disabled="#{editCAsMBean.checkboxAcceptRevocationsNonExistingEntryDisabled}">
						<f:ajax
							render="selectdefaultcertificateprofile checkboxuseappendonlytable" />
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxacceptrevocationsnonexistingentry"
						value="#{web.text.ACCEPT}" />
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:outputLabel value="#{web.text.CERTIFICATEPROFILEFORNONEXISTING}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Default_Certificate_Profile_for_Non-Existing_Entries')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:selectOneMenu id="selectdefaultcertificateprofile"
						value="#{editCAsMBean.caInfoDto.defaultCertificateProfile}"
						disabled="#{editCAsMBean.certificateProfileForNonExistingDisabled}">
						<f:selectItems value="#{editCAsMBean.throwAwayDefaultProfileList}" />
					</h:selectOneMenu>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:outputLabel value="#{web.text.USEAPPENDONLYTABLE}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Use_Append-Only_Table')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup
					rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.caInfoDto.useCertificateStorage}">
					<h:selectBooleanCheckbox id="checkboxuseappendonlytable"
						value="#{editCAsMBean.caInfoDto.useNoConflictCertificateData}"
						disabled="#{editCAsMBean.certificateProfileForNonExistingDisabled}">
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxuseappendonlytable"
						value="#{web.text.USE}" />
				</h:panelGroup>
            </h:panelGrid>	
		
			<!-- ==================================================================== Directives =================================================================================== -->

			<!-- ==================================================================== CA certificate data ========================================================================== -->

			<h:panelGrid columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row0,Row1"
				columnClasses="editColumn1,editColumn2"
				rendered="#{not editCAsMBean.renderCvcAvailable and not editCAsMBean.caTypeCits}">

				<h:outputLabel for="header_ca_certificate_data"
					value="#{web.text.CACERTIFICATEDATA}" style="font-weight: bold;" />
				<h:panelGroup id="header_ca_certificate_data" />

				<h:panelGroup>
					<h:outputLabel for="textfieldsubjectdn"
						value="#{web.text.CERT_SUBJECTDN}" style="font-weight: bold;" />
				</h:panelGroup>
				<h:panelGroup id="subjectDnInputGroup">
					<h:outputText class="dn" value="#{editCAsMBean.caInfoDto.caSubjectDN}"
						rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized}" />
					<h:inputText name="textfieldsubjectdn" size="45" maxlength="225"
						value="#{editCAsMBean.caInfoDto.caSubjectDN}" title="#{web.text.FORMAT_DN}"
						rendered="#{editCAsMBean.editCA and editCAsMBean.caUninitialized}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:validator
							validatorId="org.ejbca.ui.web.admin.ca.validators.CvcSubjectDNValidator"
							disabled="#{not editCAsMBean.caInfoDto.caTypeCVC}" />
					</h:inputText>
					<h:inputText name="textfieldsubjectdn" size="45" maxlength="225"
						id="textfieldsubjectdn" value="#{editCAsMBean.caInfoDto.caSubjectDN}"
						title="#{web.text.FORMAT_DN}"
						rendered="#{not editCAsMBean.editCA}"
						disabled="#{not editCAsMBean.hasEditRight}"
						label="Ca Cert Subject DN" styleClass="mandatory"
						required="true">
						<f:validator
							validatorId="org.ejbca.ui.web.admin.ca.validators.CvcSubjectDNValidator"
							disabled="#{not editCAsMBean.caInfoDto.caTypeCVC}" />
					</h:inputText>
                    <br />
					<h:outputText styleClass="smallHelp" value="#{web.text.SUBJECTDN_CA_HELP}"
					    rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.editCA}"/>
                    <h:outputText styleClass="smallHelp" value="#{web.text.SUBJECTDN_CA_CVC_HELP}"
                        rendered="#{editCAsMBean.caInfoDto.caTypeCVC and not editCAsMBean.editCA}"/>
				</h:panelGroup>

				<c:if test="#{not editCAsMBean.caTypeProxy}">
					<h:panelGroup
						rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized}">
						<h:outputLabel for="cert_issuerdn"
							value="#{web.text.CERT_ISSUERDN}" />
					</h:panelGroup>
					<h:panelGroup
						rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized}">
						<h:outputText id="cert_issuerdn" value="#{editCAsMBean.caIssuerDN}" />
					</h:panelGroup>

					<h:panelGroup>
						<h:outputLabel for="cert_signedby" value="#{web.text.SIGNEDBY}" />
					</h:panelGroup>

					<h:panelGroup
						rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized}">
						<h:outputText id="cert_signedby"
							value="#{editCAsMBean.signedByAsText}" />
					</h:panelGroup>

					<h:panelGroup
						rendered="#{not editCAsMBean.editCA or editCAsMBean.caUninitialized}">
						<h:selectOneMenu id="cadatasignedby" value="#{editCAsMBean.caInfoDto.signedBy}"
							disabled="#{not editCAsMBean.hasEditRight}">
							<f:selectItems value="#{editCAsMBean.signedByList}" />
							<f:ajax event="change"
								render="textfieldvalidity
										buttonmakerequest
										buttoncreate
										checkboxactivatecmsservice
										textfieldnameconstraintsexcluded
										textfieldnameconstraintspermitted
										textfieldpolicyid
										textfieldsubjectaltname
										selectcertificateprofile"
							/>
						</h:selectOneMenu>
					</h:panelGroup>

					<h:panelGroup>
						<h:outputLabel
							value="#{web.text.CERTIFICATEPROFILE}" />
					</h:panelGroup>

					<h:panelGroup>
						<h:outputText name="selectcertificateprofile"
							value="#{editCAsMBean.certificateProfileEditCAUninitialized}"
							rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized}" />
						<h:selectOneMenu id="selectcertificateprofile"
							value="#{editCAsMBean.caInfoDto.currentCertProfile}"
							rendered="#{editCAsMBean.renderSelectCertificateProfile}"
							disabled="#{!editCAsMBean.hasEditRight or editCAsMBean.signedByExternal and !editCAsMBean.caUninitialized}">
							<f:selectItems value="#{editCAsMBean.certificateProfiles}" />
						</h:selectOneMenu>
					</h:panelGroup>

					<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
						<h:outputLabel value="#{web.text.CERT_VALIDITY}"
							style="font-weight: bold;" />
						<h:outputLabel
							value=" #{web.text.FORMAT_TIME_YMODHMS} #{web.text.ORENDDATE}" />
						<h:outputText
							value="#{web.ejbcaWebBean.getHelpReference('/Certificate_Profile_Fields.html#validity')}"
							escape="false" styleClass="helpReference"/>
					</h:panelGroup>
					<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
						<h:outputText value="#{editCAsMBean.hideValidity ? web.text.NOTUSED : editCAsMBean.caEncodedValidity}"
							rendered="#{editCAsMBean.caExternal or editCAsMBean.signByExternal}" />
						<h:inputText name="textfieldvalidity" id="textfieldvalidity"
							size="25" maxlength="225"
							value="#{editCAsMBean.caEncodedValidity}"
							title="#{web.text.FORMAT_TIME_YMODHMS} #{web.text.OR} #{web.text.FORMAT_ISO8601}"
							rendered="#{not editCAsMBean.caExternal and not editCAsMBean.signByExternal}"
							disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.signedByExternal}"
							label="Ca Validity" styleClass="mandatory"
							required="true" >
						</h:inputText>

						<h:outputText styleClass="help"
							value="#{web.text.CERT_VALIDITY_CA_HELP}"
							rendered="#{editCAsMBean.editCA and not editCAsMBean.hideValidity}" style="margin-left: 3px;"/>
						<br />
						<h:outputText styleClass="smallHelp"
							value="#{editCAsMBean.certificateValidityHelp}"
							rendered="#{not editCAsMBean.hideValidity}"/>
					</h:panelGroup>

					<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509 or editCAsMBean.caInfoDto.caTypeSsh}">
						<h:outputLabel for="textfieldsubjectaltname"
							value="#{web.text.EXT_PKIX_SUBJECTALTNAME}" />
					</h:panelGroup>

					<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509 or editCAsMBean.caInfoDto.caTypeSsh}">
						<h:outputText name="textfieldsubjectaltname"
							value="#{editCAsMBean.caSubjectAltName}"
							rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized and editCAsMBean.caInfoDto.caTypeX509}" />
						<h:inputText id="textfieldsubjectaltname" size="45" maxlength="255"
							value="#{editCAsMBean.caSubjectAltName}"
							title="#{web.text.FORMAT_GENERALNAMES}"
							rendered="#{not editCAsMBean.editCA or editCAsMBean.caUninitialized}"
							disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.signedByExternal}" />
					</h:panelGroup>

					<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509}">
						<h:outputLabel for="textfieldpolicyid"
							value="#{web.text.EXT_PKIX_CP_POLICYID}"
							style="font-weight: bold;" />
					</h:panelGroup>

					<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509}">
						<h:outputText name="textfieldpolicyid"
							value="#{editCAsMBean.caInfoDto.policyId}"
							rendered="#{editCAsMBean.editCA and not editCAsMBean.caUninitialized}" />
						<h:inputText id="textfieldpolicyid" size="45" maxlength="255"
							value="#{editCAsMBean.caInfoDto.policyId}" title="#{web.text.FORMAT_OID}"
							rendered="#{not editCAsMBean.editCA or editCAsMBean.caUninitialized}"
							disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.signedByExternal}" />
						<br />
						<h:outputText styleClass="smallHelp"
							value="#{web.text.EXT_PKIX_CP_POLICYID_HELP}"
							rendered="#{not editCAsMBean.editCA or editCAsMBean.caUninitialized}" />
					</h:panelGroup>


					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
						<h:outputLabel for="checkboxuseutf8policytext"
							value="#{web.text.EXT_PKIX_CP_UTF8NOTICETEXT}" />
					</h:panelGroup>

					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
						<h:selectBooleanCheckbox id="checkboxuseutf8policytext"
							value="#{editCAsMBean.caInfoDto.useUtf8Policy}"
							disabled="#{not editCAsMBean.hasEditRight}" />
						<h:outputLabel for="checkboxuseutf8policytext"
							value="#{web.text.USE}" />
					</h:panelGroup>


					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
						<h:outputLabel for="checkboxuseprintablestringsubjectdn"
							value="#{web.text.CERT_SUBJECTDN_PRINTABLESTR}" />
					</h:panelGroup>

					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
						<h:selectBooleanCheckbox id="checkboxuseprintablestringsubjectdn"
							value="#{editCAsMBean.caInfoDto.usePrintableStringSubjectDN}"
							disabled="#{not editCAsMBean.hasEditRight}" />
						<h:outputLabel for="checkboxuseprintablestringsubjectdn"
							value="#{web.text.USE}" />
					</h:panelGroup>

					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and not editCAsMBean.caInfoDto.caTypeCVC}">
						<h:outputLabel for="checkboxuseldapdnorder"
							value="#{web.text.CERT_SUBJECTDN_LDAPORDER}"
							style="font-weight: bold;" />
						<h:outputText
							value="#{web.ejbcaWebBean.getHelpReference('/Certificate_Profile_Fields.html#Use_LDAP_DN_Order')}"
							escape="false" styleClass="helpReference"/>
					</h:panelGroup>

					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and not editCAsMBean.caInfoDto.caTypeCVC}">
						<h:selectBooleanCheckbox id="checkboxuseldapdnorder"
							value="#{editCAsMBean.caInfoDto.useLdapDNOrder}"
							disabled="#{not editCAsMBean.hasEditRight}" />
						<h:outputLabel for="checkboxuseldapdnorder" value="#{web.text.USE}" />
					</h:panelGroup>

					<h:panelGroup rendered="#{not editCAsMBean.caInfoDto.caTypeCVC and not editCAsMBean.caExternal}">
						<h:outputLabel for="caSerialNumberOctetSize" value="#{web.text.SERIALNUMBER_OCTET_SIZE}" />
						<h:outputText
							value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Serial_Number_Octet_Size')}"
							escape="false" styleClass="helpReference"/>
					</h:panelGroup>
					<h:panelGroup rendered="#{not editCAsMBean.caInfoDto.caTypeCVC and not editCAsMBean.caExternal}">
						<h:inputText id="caSerialNumberOctetSize" size="4" maxlength="2"
							value="#{editCAsMBean.caInfoDto.caSerialNumberOctetSize}"
							disabled="#{not editCAsMBean.hasEditRight}">
							<f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.OctetSizeValidator"/>
						</h:inputText>
					</h:panelGroup>

					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
						<h:outputLabel for="textfieldnameconstraintspermitted"
							value="#{web.text.EXT_PKIX_NC_PERMITTED}" />
						<h:outputText
							value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Name_Constraints')}"
							escape="false" styleClass="helpReference" />
					</h:panelGroup>

					<h:panelGroup layout="block"
						rendered="#{not editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
						<h:inputTextarea id="textfieldnameconstraintspermitted" rows="4"
							cols="38" value="#{editCAsMBean.caInfoDto.nameConstraintsPermitted}"
							disabled="#{not editCAsMBean.hasEditRight or (!editCAsMBean.editCA and editCAsMBean.signedByExternal)}" />
						<br />
						<h:outputText styleClass="smallHelp"
							value="#{web.text.EXT_PKIX_NC_PERMITTED_HELP1}"/>
						<br />
						<h:outputText styleClass="smallHelp"
							value="#{web.text.EXT_PKIX_NC_PERMITTED_HELP2}"/>
						<br />
						<h:outputText styleClass="smallHelp"
							value="#{web.text.EXT_PKIX_NC_PERMITTED_HELP3}"/>
					</h:panelGroup>

					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
						<h:outputLabel for="textfieldnameconstraintsexcluded"
							value="#{web.text.EXT_PKIX_NC_EXCLUDED}" />
						<h:outputText
							value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Name_Constraints')}"
							escape="false" styleClass="helpReference"/>

					</h:panelGroup>

					<h:panelGroup
						rendered="#{not editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
						<h:inputTextarea id="textfieldnameconstraintsexcluded" rows="4"
							cols="38" value="#{editCAsMBean.caInfoDto.nameConstraintsExcluded}"
							disabled="#{not editCAsMBean.hasEditRight or (!editCAsMBean.editCA and editCAsMBean.signedByExternal)}" />
						<br />
						<h:outputText styleClass="smallHelp"
							value="#{web.text.EXT_PKIX_NC_EXCLUDED_HELP1}"/>
						<br />
						<h:outputText styleClass="smallHelp"
							value="#{web.text.EXT_PKIX_NC_EXCLUDED_HELP2}"/>
					</h:panelGroup>

					<h:panelGroup
						rendered="#{editCAsMBean.editCA and not editCAsMBean.waitingResponse and not editCAsMBean.caUninitialized}">
						<h:outputLabel for="checkboxuseldapdnorder"
							value="#{web.text.CACERTIFICATE}" style="font-weight: bold;" />
					</h:panelGroup>
					<h:panelGroup
						rendered="#{editCAsMBean.editCA and not editCAsMBean.waitingForResponse and not editCAsMBean.caUninitialized}">
						<h:commandButton type="button"
							onclick="viewcacert('#{editCAsMBean.caCertLink}')"
							title="#{web.text.VIEW_CACERTIFICATE_TITLE} #{web.text.POPUP_WINDOW}"
							value="#{web.text.VIEW_CERTIFICATE}"
							disabled="#{not editCAsMBean.editCA or editCAsMBean.waitingForResponse}" />
					</h:panelGroup>
					
					<h:panelGroup
						rendered="#{editCAsMBean.caInfoDto.caTypeX509 and (not editCAsMBean.waitingResponse) 
									and (not editCAsMBean.caUninitialized)}">
						<h:outputLabel 
							value="#{web.text.CACERTIFICATEALTERNATECHAIN}" style="font-weight: bold;" />
						<br />
						<h:outputText styleClass="smallHelp"
							value="#{web.text.CACERTIFICATEALTERNATECHAIN_HELP}"/>
						<br/>
						<h:outputText
							value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#X509CrossCertificateChain(s)')}"
							escape="false" styleClass="helpReference" />
					</h:panelGroup>
					<h:panelGroup 
						rendered="#{editCAsMBean.caInfoDto.caTypeX509 and (not editCAsMBean.waitingForResponse) 
									and (not editCAsMBean.caUninitialized)}">
							<h:panelGroup id="alternatecertchainssection">
								<ui:repeat value="#{editCAsMBean.alternateCertChains}" var="altchain">
									<h:selectBooleanCheckbox rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}"
										value="#{editCAsMBean.removeAlternateCertChain[altchain]}">
										<f:ajax/>
									</h:selectBooleanCheckbox>
									<h:outputLink
										value="#{editCAsMBean.getDownloadCertLink()}?cmd=cacertaltchain&amp;level=0&amp;issuer=#{editCAsMBean.escapeDnString(editCAsMBean.caInfoDto.caSubjectDN)}&amp;root=#{editCAsMBean.escapeDnString(altchain)}">
										<h:outputText value="&nbsp;&nbsp;#{altchain}&nbsp;" style="font-size: 11pt"/>
									</h:outputLink>
									<br/>
								</ui:repeat>
							</h:panelGroup>
							<h:outputText value="#{web.text.NONE}" rendered="#{empty editCAsMBean.alternateCertChains}"/>
							<br/>
							<h:commandButton type="button" 
							    rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight and (not empty editCAsMBean.alternateCertChains)}"
								name="altcertchainremove"
								action="#{editCAsMBean.unlinkAlternateCertChains}"
								value="#{web.text.REMOVE}">
								<f:ajax render=":editcapage:alternatecertchainssection"/>
							</h:commandButton>
					</h:panelGroup>
				</c:if>
					
			</h:panelGrid>



			<!-- ==================================================================== CA Certificate Data ========================================================================== -->


			<!-- ==================================================================== CRL Specific Data ============================================================================ -->

			<h:panelGrid id="crlSpecificData" columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row0,Row1"
				columnClasses="editColumn1,editColumn2"
				rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.renderCvcAvailable 
										and not editCAsMBean.caTypeCits}">

				<h:outputLabel for="header_crl_specific_data"
					value="#{web.text.CRLSPECIFICDATA}" style="font-weight: bold;" />
				<h:panelGroup id="header_crl_specific_data" />

				<!-- External CA -->
				<h:panelGroup
					rendered="#{editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
					<h:outputText name="textfieldexternalcdp"
						value="#{web.text.CRL_CA_CRLDP_EXTERNAL}" />
				</h:panelGroup>
				<h:panelGroup
					rendered="#{editCAsMBean.caExternal and editCAsMBean.caInfoDto.caTypeX509}">
					<h:inputText name="textfieldexternalcdp" size="45" maxlength="255"
						value="#{editCAsMBean.crlCaCRLDPExternal}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.CrlDistributionPointUrlValidator"/>
						<f:attribute name="errorMessage" value="#{web.text.CRL_CA_CRLDP_EXTERNAL_ERROR}"/>						
					</h:inputText>
				</h:panelGroup>

				<!-- Microsoft CA Compatibility Mode -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.MS_COMPATIBILIY_MODE}" />
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:panelGroup id="mscompatiblegroup">
						<h:panelGroup rendered="#{not editCAsMBean.caInfoDto.msCaCompatible}">
							<h:selectBooleanCheckbox id="mscompatible"
													 value="#{editCAsMBean.caInfoDto.msCaCompatible}"
													 onclick="return checkboxConfirmation('#{web.text.MS_COMPATIBILIY_MODE_CONFIRMATION}', 'editcapage:mscompatible')"
													 disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.caExternal or editCAsMBean.checkboxMsCaCompatibilityDisabled}">
								<f:ajax immediate="true" render="mscompatiblegroup editcapage:crlSpecificData" />
							</h:selectBooleanCheckbox>
							<h:outputLabel for="mscompatible"
										   value="#{web.text.USE}" />
							<br/>
							<h:outputText rendered="#{not editCAsMBean.caInfoDto.msCaCompatible and not editCAsMBean.checkboxMsCaCompatibilityDisabled}"
										  styleClass="warning"
										  value="#{web.text.MS_COMPATIBILIY_MODE_WARNING}" />
							<h:outputText rendered="#{not editCAsMBean.caInfoDto.msCaCompatible and editCAsMBean.checkboxMsCaCompatibilityDisabled}"
										  styleClass="help"
										  value="#{web.text.MS_COMPATIBILIY_MODE_DISABLED}" />
						</h:panelGroup>

						<h:outputText rendered="#{editCAsMBean.caInfoDto.msCaCompatible}"
									  value="#{web.text.MS_COMPATIBILIY_MODE_IRREVERSIBLE}" />
					</h:panelGroup>
				</h:panelGroup>

				<!-- Authority Key Id -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_EXT_AUTHORITYKEYID}" />
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectBooleanCheckbox id="checkboxauthoritykeyidentifier"
						value="#{editCAsMBean.caInfoDto.useAuthorityKeyIdentifier}"
						disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.caExternal}">
						<f:validator validatorId="org.ejbca.util.validator.RequiredCheckboxValidator"
									 disabled="#{editCAsMBean.caExternal or not editCAsMBean.authorityKeyIdentifierValidated}"/>
						<f:attribute name="errorMessage" value="#{web.text.MS_COMPABILITY_MODE_WITHOUT_AUTHORITYKEYID}"/>
						<f:ajax render="checkboxauthoritykeyidentifiercritical"/>
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxauthoritykeyidentifier"
						value="#{web.text.USE}" />
					&nbsp;
					<h:selectBooleanCheckbox
						id="checkboxauthoritykeyidentifiercritical"
						value="#{editCAsMBean.caInfoDto.authorityKeyIdentifierCritical}"
						disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.checkboxAuthorityKeyIdentifierCriticalDisabled}" />
					<h:outputLabel for="checkboxauthoritykeyidentifiercritical"
						value="#{web.text.EXT_CRITICAL}" />
				</h:panelGroup>

				<!-- CRL Number -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_EXT_CRLNUMBER}" />
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectBooleanCheckbox id="checkboxusecrlnumber"
						value="#{editCAsMBean.caInfoDto.useCrlNumber}"
						disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.caExternal}">
					<f:ajax render="checkboxcrlnumbercritical"/>
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxusecrlnumber" value="#{web.text.USE}" />
					&nbsp;
					<h:selectBooleanCheckbox id="checkboxcrlnumbercritical"
						value="#{editCAsMBean.caInfoDto.crlNumberCritical}"
						disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.checkboxCrlNumberCriticalDisabled}" />
					<h:outputLabel for="checkboxcrlnumbercritical"
						value="#{web.text.EXT_CRITICAL}" />
				</h:panelGroup>

				<!-- CRL Issuing Distribution -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_EXT_ISSUINGDISTPOINT}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Issuing_Distribution_Point_on_CRLs')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectBooleanCheckbox id="checkboxusecrldistributionpointoncrl"
						value="#{editCAsMBean.caInfoDto.useCrlDistributiOnPointOnCrl}"
						disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.caExternal}">
						<f:validator validatorId="org.ejbca.util.validator.RequiredCheckboxValidator"
									 disabled="#{editCAsMBean.caExternal or not editCAsMBean.issuingDistributionPointValidated}"/>
						<f:attribute name="errorMessage" value="#{web.text.PARTITIONEDCRLS_WITHOUT_IDPONCRL}"/>
						<f:ajax render="checkboxcrldistributionpointoncrlcritical"/>
					</h:selectBooleanCheckbox>

					<h:outputLabel for="checkboxusecrldistributionpointoncrl"
						value="#{web.text.USE}" />
					&nbsp;
					<h:selectBooleanCheckbox
						id="checkboxcrldistributionpointoncrlcritical"
						value="#{editCAsMBean.caInfoDto.crlDistributionPointOnCrlCritical}"
						disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.checkboxCrlDistributionPointOnCrlCriticalDisabled}" />
					<h:outputLabel for="checkboxcrldistributionpointoncrlcritical"
						value="#{web.text.EXT_CRITICAL}" />
				</h:panelGroup>

				<!-- CA Issuers URI -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_EXT_CAISSUERS_URI}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#CRL_CA_Issuer_URI')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}" >
					<h:inputText size="40" maxlength="256"
						id="textfieldauthorityinformationaccess"
						value="#{editCAsMBean.caInfoDto.authorityInformationAccess}"
						disabled="#{editCAsMBean.editCA and not editCAsMBean.hasEditRight}">
						<f:validator validatorId="urlValidator"/>
						<f:attribute name="errorMessage" value="#{web.text.CRL_EXT_CAISSUERS_URI_ERROR}"/>						
					</h:inputText>						
				</h:panelGroup>

				<!-- EXT: Authority Information Access -->
				<h:panelGroup rendered="#{editCAsMBean.caExternal}"></h:panelGroup>
				<h:panelGroup rendered="#{editCAsMBean.caExternal}">
					<h:outputText value="#{editCAsMBean.caInfoDto.authorityInformationAccess}" />
				</h:panelGroup>

				<!-- Keep Expired CRL -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.KEEPEXPIREDONCRL}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Keep_Expired_Certificates_on_CRL')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectBooleanCheckbox id="checkboxkeepexpiredoncrl"
						value="#{editCAsMBean.caInfoDto.keepExpiredOnCrl}"
						disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.caExternal}" />
					<h:outputLabel for="checkboxkeepexpiredoncrl"
						value="#{web.text.USE}" />
				</h:panelGroup>

				<!-- Use CRL Partitions -->
				<h:panelGroup id="useCrlPartitionsTitle"
							  rendered="#{not editCAsMBean.caExternal and not editCAsMBean.caInfoDto.msCaCompatible}">
						<h:outputText  value="#{web.text.USECRLPARTITIONS}" />
				</h:panelGroup>
				<h:panelGroup id="useCrlPartitionsGroup"
							  rendered="#{not editCAsMBean.caExternal and not editCAsMBean.caInfoDto.msCaCompatible}">
					<h:selectBooleanCheckbox id="checkboxusecrlpartitions"
											 value="#{editCAsMBean.caInfoDto.usePartitionedCrl}"
											 disabled="#{not editCAsMBean.hasEditRight}">
						<f:ajax render=":editcapage:mscompatiblegroup :editcapage:crlNumberOfPartitionsLabelGroup :editcapage:crlNumberOfPartitionsInputGroup :editcapage:suspendedPartitionLabelGroup :editcapage:suspendedPartitionInputGroup"
							onevent="function (ev) { if (ev.status == 'success') { ejbca.adminweb.hideShowCellsByClass('crlPartitionCellContents', ev.source.checked); } } "/>
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxusecrlpartitions"
								   value="#{web.text.USE}" />
					<h:outputScript rendered="${not editCAsMBean.usePartitionedCrlChecked}">
					if (document.readyState != 'complete') {
						document.addEventListener('DOMContentLoaded', function () { ejbca.adminweb.hideShowCellsByClass('crlPartitionCellContents', false); });
					} else {
						ejbca.adminweb.hideShowCellsByClass('crlPartitionCellContents', false);
					}
					</h:outputScript>
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal and not editCAsMBean.caInfoDto.msCaCompatible}">
					<h:panelGroup id="crlNumberOfPartitionsLabelGroup" styleClass="crlPartitionCellContents">
						<h:outputText value="#{web.text.CRLPARTITIONNUMBER}" />
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal and not editCAsMBean.caInfoDto.msCaCompatible}">
				    <h:panelGroup id="crlNumberOfPartitionsInputGroup" styleClass="crlPartitionCellContents">
						<h:inputText id="crlpartitions"  value="#{editCAsMBean.caInfoDto.crlPartitions}" size="3" title="#{web.text.FORMAT_INTEGER}"
									 converterMessage="#{web.text.ONLYDECINCRLPARTITIONS}" validatorMessage="#{web.text.ONLYDECINCRLPARTITIONS}"
									 disabled="#{not editCAsMBean.hasEditRight}" >
							<f:validateLength minimum="1"/>
							<f:validateLongRange minimum="0"/>
						</h:inputText>
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal and not editCAsMBean.caInfoDto.msCaCompatible}">
					<h:panelGroup id="suspendedPartitionLabelGroup" styleClass="crlPartitionCellContents">
						<h:outputText value="#{web.text.CRLSUSPENDEDPARTITIONNUMBER}" rendered="#{not editCAsMBean.caExternal}" />
					</h:panelGroup>
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExternal and not editCAsMBean.caInfoDto.msCaCompatible}">
					<h:panelGroup id="suspendedPartitionInputGroup" styleClass="crlPartitionCellContents">
						<h:inputText id="crlsuspendedpartitions" value="#{editCAsMBean.caInfoDto.suspendedCrlPartitions}" size="3" title="#{web.text.FORMAT_INTEGER}"
									 converterMessage="#{web.text.ONLYDECINCRLPARTITIONS}" validatorMessage="#{web.text.ONLYDECINCRLPARTITIONS}"
									 rendered="#{not editCAsMBean.caExternal}"
									 disabled="#{not editCAsMBean.hasEditRight or editCAsMBean.caExternal}" >
							<f:validateLength minimum="1"/>
							<f:validateLongRange minimum="0"/>
						</h:inputText>
					</h:panelGroup>
				</h:panelGroup>

				<!-- CRL Period -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_CA_CRLPERIOD}"
						style="font-weight: bold;" />
					<h:outputText value=" #{web.text.FORMAT_TIME_YMDHMIN}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#CRL_Period')}"
						escape="false" styleClass="helpReference"/>

				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{editCAsMBean.caInfoDto.crlCaCrlPeriod}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="20" maxlength="255" name="textfieldcrlperiod"
						id="textfieldcrlperiod" value="#{editCAsMBean.caInfoDto.crlCaCrlPeriod}"
						disabled="#{not editCAsMBean.hasEditRight}" label="Ca Crl Period"
						styleClass="mandatory" required="true"> 
						<f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.CRLFieldValidator"/>
					</h:inputText>	
						&nbsp; 
					<h:outputText styleClass="help"
						value="#{web.text.YEAR365DAYS}  ,  #{web.text.MO30DAYS}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_CA_ISSUEINTERVAL}" />
					<h:outputText value=" #{web.text.FORMAT_TIME_YMDHMIN}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#CRL_Period')}"
						escape="false" styleClass="helpReference"/>

				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{editCAsMBean.caInfoDto.crlCaIssueInterval}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="20" maxlength="255"
						id="textfieldcrlissueinterval"
						value="#{editCAsMBean.caInfoDto.crlCaIssueInterval}"
						disabled="#{not editCAsMBean.hasEditRight}" >
					<f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.CRLFieldValidator"/>
					</h:inputText>	
						&nbsp; 
					<h:outputText styleClass="help"
						value="#{web.text.YEAR365DAYS}  ,  #{web.text.MO30DAYS}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_CA_OVERLAPTIME}" />
					<h:outputText value=" #{web.text.FORMAT_TIME_YMDHMIN}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#CRL_Period')}"
						escape="false" styleClass="helpReference"/>

				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{editCAsMBean.caInfoDto.crlCaOverlapTime}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="20" maxlength="255"
						id="textfieldcrloverlaptime"
						value="#{editCAsMBean.caInfoDto.crlCaOverlapTime}"
						disabled="#{not editCAsMBean.hasEditRight}" >
					<f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.CRLFieldValidator"/>
					</h:inputText>	
						&nbsp; 
					<h:outputText styleClass="help"
						value="#{web.text.YEAR365DAYS}  ,  #{web.text.MO30DAYS}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_CA_DELTACRLPERIOD}" />
					<h:outputText value=" #{web.text.FORMAT_TIME_YMDHMIN}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#CRL_Period')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{editCAsMBean.caInfoDto.crlCaOverlapTime}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="20" maxlength="255"
						name="textfielddeltacrlperiod" id="textfielddeltacrlperiod"
						value="#{editCAsMBean.caInfoDto.crlCaDeltaCrlPeriod}"
						disabled="#{not editCAsMBean.hasEditRight}"
						label="Ca Delta Crl Period" styleClass="mandatory"
						required="true">
					<f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.CRLFieldValidator"/>
					</h:inputText>	
						&nbsp;
					<h:outputText styleClass="help" value="#{web.text.YEAR365DAYS}  ,  #{web.text.MO30DAYS}" />
					<br />
					<h:outputLabel value="#{web.text.CRL_CA_DELTACRLPERIOD_HELP}" styleClass="smallHelp" />
				</h:panelGroup>

				<!-- Generate CRL Upon Revocation -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.CRL_CA_GENERATEUPONREVOCATION}" 
						rendered="#{not editCAsMBean.caExternal}" />
				</h:panelGroup>
				
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectBooleanCheckbox id="checkboxgeneratecrluponrevocation"
											 value="#{editCAsMBean.caInfoDto.generateCrlUponRevocation}"
											 disabled="#{not editCAsMBean.hasEditRight}">
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxgeneratecrluponrevocation"
								   value="#{web.text.USE}" />
					<br />
					<h:outputLabel value="#{web.text.CRL_CA_GENERATEUPONREVOCATION_HELP}" styleClass="smallHelp" />
				</h:panelGroup>

				<!-- Allow changing revocation reason -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.ALLOW_CHANGING_REVOCATION_REASON}" rendered="#{not editCAsMBean.caExternal}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectBooleanCheckbox id="checkboxallowchangingrevocationreason"
											 value="#{editCAsMBean.caInfoDto.allowChangingRevocationReason}"
											 disabled="#{not editCAsMBean.hasEditRight}">
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxallowchangingrevocationreason" value="#{web.text.USE}" />
				</h:panelGroup>

				<!-- Allow invalidity date -->
				<h:panelGroup>
					<h:outputText value="#{web.text.ALLOW_INVALIDITY_DATE}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:selectBooleanCheckbox id="checkboxallowinvaliditydate"
											 value="#{editCAsMBean.caInfoDto.allowInvalidityDate}"
											 disabled="#{not editCAsMBean.hasEditRight}">
					</h:selectBooleanCheckbox>
					<h:outputLabel for="checkboxallowinvaliditydate" value="#{web.text.USE}" />
				</h:panelGroup>

				<!-- Publishers -->
				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:outputText value="#{web.text.PUBLISHERS}"
						rendered="#{not editCAsMBean.caExternal}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">
					<h:selectManyListbox styleClass="select-list" size="5"
						name="selectavailablecrlpublishers"
						disabled="#{not editCAsMBean.hasEditRight}"
						value="#{editCAsMBean.usedCrlPublishers}">
						<f:selectItems value="#{editCAsMBean.availableCrlPublishers}" />
					</h:selectManyListbox>
				</h:panelGroup>

			</h:panelGrid>

			<!-- ==================================================================== CRL Specific Data ============================================================================ -->

			<!-- ==================================================================== Default CA Defined Validation Data =========================================================== -->
			<h:panelGrid columns="2" styleClass="edit-top" cellspacing="3"
				cellpadding="3" border="0" width="100%" rowClasses="Row0,Row1"
				columnClasses="editColumn1,editColumn2"
				rendered="#{editCAsMBean.caInfoDto.caTypeX509 and not editCAsMBean.caExternal 
								and not editCAsMBean.renderCvcAvailable and not editCAsMBean.caTypeCits}">
				<h:outputLabel value="#{web.text.DEFAULT_VALIDATION_DATA}"
					style="font-weight: bold;" />
				<h:outputLabel value="#{web.text.DEFAULT_VALIDATION_DATA_HELP}"
					style="font-size: small;" />

				<h:panelGroup>
					<h:outputText value="#{web.text.EXT_PKIX_CDP_DEFAULTURI}"
						rendered="#{not editCAsMBean.caExternal}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/Certificate_Profile_Fields.html#CRL_Distribution_Points')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:outputText value="#{editCAsMBean.caInfoDto.defaultCRLDistPoint}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="40" maxlength="4096"
						id="textfielddefaultcrldistpoint" title="#{web.text.FORMAT_URI}"
						value="#{editCAsMBean.caInfoDto.defaultCRLDistPoint}"
						rendered="#{not editCAsMBean.caExternal}"
						disabled="#{not editCAsMBean.hasEditRight}"
						required="#{editCAsMBean.caInfoDto.usePartitionedCrl or editCAsMBean.caInfoDto.msCaCompatible}" requiredMessage="#{web.text.PARTITIONEDCRLS_WITHOUT_DEFAULTCDP}">
                        <f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.CrlDistributionPointUrlValidator"/>
                        <f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.PartitionedCrlUrlValidator"
                                     disabled="#{editCAsMBean.caExternal or not editCAsMBean.defaultCRLDistributionPointValidated}"/>
						<f:attribute name="errorMessage" value="#{web.text.EXT_PKIX_CDP_DEFAULTURI_ERROR}"/>
					</h:inputText>
					<h:commandButton type="button"
						action="#{editCAsMBean.genDefaultCrlDistPoint}"
						value="#{web.text.GENERATE}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:ajax render=":editcapage:textfielddefaultcrldistpoint" execute="checkboxusecrlpartitions subjectDnInputGroup"/>
					</h:commandButton>
					<br />
					<h:outputLabel value="#{web.text.CRL_CA_DEFAULTVALUES_HELP}" styleClass="smallHelp" />

				</h:panelGroup>

				<h:panelGroup>
					<h:outputText value="#{web.text.EXT_PKIX_CDP_DEFAULTCRLISSUER}"
						rendered="#{not editCAsMBean.caExternal}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/Certificate_Profile_Fields.html#CRL_Issuer')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:outputText value="#{editCAsMBean.caInfoDto.defaultCRLIssuer}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="40" maxlength="255"
						id="textfielddefaultcrlissuer" title="#{web.text.FORMAT_DN}"
						value="#{editCAsMBean.caInfoDto.defaultCRLIssuer}"
						rendered="#{not editCAsMBean.caExternal}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:commandButton type="button"
						action="#{editCAsMBean.genDefaultCrlIssuer}"
						value="#{web.text.GENERATE}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:ajax render=":editcapage:textfielddefaultcrlissuer" execute="subjectDnInputGroup textfielddefaultcrlissuer"/>
					</h:commandButton>
					<br />
					<h:outputLabel value="#{web.text.CRL_CA_DEFAULTVALUES_HELP}" styleClass="smallHelp" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputText value="#{web.text.EXT_PKIX_FCRL_DEFAULTURI}"
						rendered="#{not editCAsMBean.caExternal}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/Certificate_Profile_Fields.html#Freshest_CRL')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:outputText value="#{editCAsMBean.caInfoDto.caDefinedFreshestCRL}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="40" maxlength="255"
						id="textfieldcadefinedfreshestcrl" title="#{web.text.FORMAT_URI}"
						value="#{editCAsMBean.caInfoDto.caDefinedFreshestCRL}"
						rendered="#{not editCAsMBean.caExternal}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:validator validatorId="urlValidator"/>
						<f:attribute name="errorMessage" value="#{web.text.EXT_PKIX_FCRL_DEFAULTURI_ERROR}"/>						
					</h:inputText>
					<h:commandButton type="button"
						action="#{editCAsMBean.genCaDefinedFreshestCrl}"
						value="#{web.text.GENERATE}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:ajax render=":editcapage:textfieldcadefinedfreshestcrl" execute="checkboxusecrlpartitions subjectDnInputGroup textfieldcadefinedfreshestcrl"/>
					</h:commandButton>
					<br />
					<h:outputLabel value="#{web.text.CRL_CA_DEFAULTVALUES_HELP}" styleClass="smallHelp" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputText value="#{web.text.EXT_PKIX_AIA_OCSP_DEFAULTURI}"
						rendered="#{not editCAsMBean.caExternal}"
						style="font-weight: bold;" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Default_CA_Defined_Validation_Data')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:outputText value="#{editCAsMBean.caInfoDto.defaultOCSPServiceLocator}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="40" maxlength="255"
						id="textfielddefaultocsplocator" title="#{web.text.FORMAT_URI}"
						value="#{editCAsMBean.caInfoDto.defaultOCSPServiceLocator}"
						rendered="#{not editCAsMBean.caExternal}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:validator validatorId="urlValidator"/>
						<f:attribute name="errorMessage" value="#{web.text.EXT_PKIX_AIA_OCSP_DEFAULTURI_ERROR}"/>
			   </h:inputText>
					<h:commandButton type="button"
						name="checkbexgeneratedefaultocsplocator"
						action="#{editCAsMBean.genDefaultOcspLocator}"
						value="#{web.text.GENERATE}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:ajax render=":editcapage:textfielddefaultocsplocator" execute="textfielddefaultocsplocator"/>
					</h:commandButton>

				</h:panelGroup>

				<h:panelGroup>
					<h:outputText value="#{web.text.EXT_PKIX_AIA_CAISSUERS_DEFAULTURI}"
						rendered="#{not editCAsMBean.caExternal}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Default_CA_Defined_Validation_Data')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:outputText
						value="#{editCAsMBean.caInfoDto.certificateAiaDefaultCaIssuerUri}"
						rendered="#{editCAsMBean.caExternal}" />
					<h:inputText size="40" maxlength="255"
						name="textfieldusercertificateaiadefaultcaissueruri"
						id="textfieldusercertificateaiadefaultcaissueruri"
						title="#{web.text.FORMAT_URI}"
						value="#{editCAsMBean.caInfoDto.certificateAiaDefaultCaIssuerUri}"
						rendered="#{not editCAsMBean.caExternal}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:validator validatorId="urlValidator"/>
						<f:attribute name="errorMessage" value="#{web.text.EXT_PKIX_AIA_CAISSUERS_DEFAULTURI_ERROR}"/>
				</h:inputText>					
				</h:panelGroup>
			</h:panelGrid>

			<!-- ==================================================================== Default CA Defined Validation Data =========================================================== -->

			<!-- ==================================================================== Approval Settings  =========================================================================== -->
			<h:panelGrid columns="2" styleClass="edit-top lone-edit-heading"
				cellspacing="3" cellpadding="3" border="0" width="100%"
				rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2"
				rendered="#{not (editCAsMBean.caExternal and not editCAsMBean.caTypeCits) and not editCAsMBean.renderCvcAvailable 
									and not editCAsMBean.caInfoDto.caTypeSsh and not editCAsMBean.caTypeProxy}">
				<h:outputLabel for="approvals" value="#{web.text.APPROVALSETTINGS}"
					style="font-weight: bold;" />
				<h:panelGroup id="approvals" />
			</h:panelGrid>
				
			<h:dataTable value="#{editCAsMBean.approvalRequestItems}"
				var="requestItem" cellspacing="1" cellpadding="3" border="0"
				width="100%" rowClasses="Row0,Row1"
				columnClasses="editColumn1,editColumn2" style="padding-right: 4px;"
				rendered="#{not (editCAsMBean.caExternal and not editCAsMBean.caTypeCits)and not editCAsMBean.renderCvcAvailable 
								and not editCAsMBean.caInfoDto.caTypeSsh and not editCAsMBean.caTypeProxy}">
				<h:column>
					<h:outputText value="#{requestItem.displayText}" />
				</h:column>
				<h:column>
					<h:selectOneMenu id="approvalProfile"
						value="#{requestItem.approvalProfileId}"
						converter="javax.faces.Integer"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:selectItems value="#{editCAsMBean.availableApprovalProfiles}" />
					</h:selectOneMenu>
				</h:column>
			</h:dataTable>

			<!-- ==================================================================== Approval Settings  =========================================================================== -->

			<!-- ==================================================================== Other Data =================================================================================== -->

			<h:panelGrid columns="2" styleClass="edit-top lone-edit-heading"
				cellspacing="3" cellpadding="3" border="0" width="100%"
				rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2"
				rendered="#{not editCAsMBean.caExternal and not editCAsMBean.renderCvcAvailable 
								and not editCAsMBean.caInfoDto.caTypeSsh and not editCAsMBean.caTypeCits
								and not  editCAsMBean.caTypeProxy}">
				<h:outputLabel for="otherdata" value="#{web.text.OTHERDATA}"
					style="font-weight: bold;" />
				<h:panelGroup id="otherdata" />

				<h:panelGroup>
					<h:outputLabel 
						value="#{web.text.VALIDATORS}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/Validators_Overview.html')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				<h:panelGroup>
					<h:selectManyListbox id="selectValidator" styleClass="select-list" size="5"
						name="selectavailablevalidators"
						disabled="#{not editCAsMBean.hasEditRight}"
						value="#{editCAsMBean.usedValidators}">
						<f:selectItems value="#{editCAsMBean.availableValidators}" />
					</h:selectManyListbox>
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="checkboxfinishuser"
						value="#{web.text.FINISHUSER}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#Finish_User')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>

				<h:panelGroup>
					<h:selectBooleanCheckbox name="checkboxfinishuser"
						id="checkboxfinishuser" value="#{editCAsMBean.caInfoDto.finishUser}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:outputLabel for="checkboxfinishuser" value="#{web.text.USE}" />
				</h:panelGroup>


				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509}">
					<h:outputLabel for="textfieldsharedcmprasecret"
						value="#{web.text.SHAREDCMPRASECRET}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#CMP_RA_Authentication_Secret')}"
						escape="false" styleClass="helpReference"/>

				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509}">
					<h:inputSecret id="textfieldsharedcmprasecret" autocomplete="off" name="textfieldsharedcmprasecret"
						size="20" maxlength="64"
						value="#{editCAsMBean.caInfoDto.sharedCmpRaSecret}"
						disabled="#{not editCAsMBean.hasEditRight}" />
				</h:panelGroup>

				<h:panelGroup>
					<h:outputLabel for="checkboxincludeinhealthcheck"
						value="#{web.text.INCLUDEINHEALTHCHECK}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/Monitoring_and_Healthcheck.html')}"
						escape="false" styleClass="helpReference"/>

				</h:panelGroup>

				<h:panelGroup>
					<h:selectBooleanCheckbox name="checkboxincludeinhealthcheck"
						id="checkboxincludeinhealthcheck"
						value="#{editCAsMBean.caInfoDto.includeInHealthCheck}"
						disabled="#{not editCAsMBean.hasEditRight}" />
					<h:outputLabel for="checkboxincludeinhealthcheck"
						value="#{web.text.ACTIVATE}" />
				</h:panelGroup>
				
				<h:panelGroup>
					<h:outputLabel for="requestProcessor"
						value="#{web.text.REQUEST_PROCESSOR}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>
				
				<h:panelGroup rendered="#{editCAsMBean.caInfoDto.caTypeX509}">				
					<h:selectOneMenu id="requestProcessor"
						value="#{editCAsMBean.caInfoDto.requestPreProcessor}"
						disabled="#{not editCAsMBean.hasEditRight}">
						<f:selectItems value="#{editCAsMBean.availableRequestPreProcessors}" />
					</h:selectOneMenu>
				</h:panelGroup>
				


			</h:panelGrid>

			<!-- ==================================================================== Other Data =================================================================================== -->

			<!-- ==================================================================== CA Life Cycle ================================================================================ -->

			<h:panelGrid columns="2" styleClass="edit-top lone-edit-heading"
				cellspacing="3" cellpadding="3" border="0" width="100%"
				rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2"
				rendered="#{editCAsMBean.renderCaLifeCycle and not editCAsMBean.renderCvcAvailable
								and not editCAsMBean.caTypeCits and not editCAsMBean.caTypeProxy}">
				<h:outputLabel for="califecycle" value="#{web.text.CALIFECYCLE}"
					style="font-weight: bold;" />
				<h:panelGroup id="califecycle"
					rendered="#{editCAsMBean.renderCaLifeCycle}" />

				<h:panelGroup>
					<h:outputText  value="#{web.text.REVOKECAWITHREASON}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.renderCaLifeCycle}">
					<h:selectOneMenu name="selectrevokereasons"
						value="#{editCAsMBean.caRevokeReason}">
						<f:selectItems value="#{editCAsMBean.revokeReasonList}" />
					</h:selectOneMenu>
        	    &nbsp;&nbsp;&nbsp;
				<h:commandButton name="buttonrevokeca" value="#{web.text.REVOKE}"
						onclick="return confirmcaaction('#{web.text.AREYOUSUREREVOKECA}')"
						action="#{editCAsMBean.revokeCa}" />
				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.renderRenewCA}">
					<h:outputLabel value="#{web.text.RENEWCA}" />
					<h:outputText
						value="#{web.ejbcaWebBean.getHelpReference('/Managing_CAs.html')}"
						escape="false" styleClass="helpReference"/>
				</h:panelGroup>


				<h:panelGroup rendered="#{editCAsMBean.renderRenewCA}">
					<h:panelGrid columns="2" columnClasses="column-editca,editColumn2">
						<h:panelGroup>
							<h:outputLabel 
								value="#{web.text.RENEWCA_NEXTCAKEY}" />
						</h:panelGroup>
						<h:panelGroup>
							<h:selectOneMenu id="selectcertsignkeyrenew"
								value="#{editCAsMBean.certSignKeyReNewValue}"
								disabled="#{not editCAsMBean.hasEditRight}">
								<f:selectItems value="#{editCAsMBean.extrAndCertSignKeyReNewList}" />
							</h:selectOneMenu>
						</h:panelGroup>

						<h:panelGroup rendered="#{editCAsMBean.renderUseCaNameChange}">
							<h:outputLabel value="#{web.text.RENEWCA_USECANAMECHANGE}"/>
							<h:outputText
								value="#{web.ejbcaWebBean.getHelpReference('/CA_Fields.html#CA_Name_Change')}"
								escape="false" styleClass="helpReference"/>
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.renderUseCaNameChange}">	
						<h:selectBooleanCheckbox name="checkboxcanamechange"
							id="idcheckboxcanamechange"
							value="#{editCAsMBean.cANameChange}"
							disabled="#{!editCAsMBean.hasEditRight}" >
							<f:ajax event="change" render=":editcapage:idnewsubjectdn" />	
						</h:selectBooleanCheckbox>
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.renderUseCaNameChange}">	
							<h:outputText value="#{web.text.RENEWCA_NEW_SUBJECT_DN_ICAO}"/>
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.renderUseCaNameChange}" >	
							<h:inputText size="45" maxlength="255" 
								title="#{web.text.FORMAT_DN}"
								value="#{editCAsMBean.newSubjectDn}"
								id="idnewsubjectdn"
							 	disabled="#{editCAsMBean.caTypeCVC or !editCAsMBean.hasEditRight or !editCAsMBean.cANameChange}" >
							 	<f:validator validatorId="org.ejbca.ui.web.admin.ca.validators.NewSubjectDNValidator"/>
							 	<f:attribute name="currentSubjectDN" value="#{editCAsMBean.caInfoDto.caSubjectDN}"/>
							</h:inputText> 	
						</h:panelGroup>
						<h:panelGroup>
							<h:outputText value="#{web.text.RENEWCA_LINKCERTIFICATE}" />
						</h:panelGroup>
						<h:panelGroup>
							<h:selectBooleanCheckbox name="checkboxcreatelinkcertificate"
								disabled="#{editCAsMBean.caTypeCVC or !editCAsMBean.hasEditRight}"
								rendered="#{editCAsMBean.caTypeCVC}" 
								value="#{editCAsMBean.createLinkCertificate}"/>
							<h:selectBooleanCheckbox name="checkboxcreatelinkcertificate"
								value="#{editCAsMBean.createLinkCertificate}" 
								disabled="#{not editCAsMBean.hasEditRight}" 
								rendered="#{!editCAsMBean.caTypeCVC}" />
						</h:panelGroup>

						<h:panelGroup/>
						<h:panelGroup>
							<h:commandButton id="buttonrenewca" value="#{web.text.RENEWCA}"
								onclick="return confirmcaaction('#{web.text.AREYOUSURERENEWCA}')"
								action="#{editCAsMBean.renewCa}"
								disabled="#{!editCAsMBean.hasEditRight}" />
						</h:panelGroup>

						<h:panelGroup>
							<h:outputText value="#{web.text.RENEWCA_FROMLASTRENEWAL}" />
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.renderLinkCertificate}">
							<h:outputLink value="#{editCAsMBean.binaryCaIdLink}" > 
								<h:outputText value="DER, " />
							</h:outputLink>
							<h:outputLink value="#{editCAsMBean.caIdLink}" >
								<h:outputText value="PEM" />
							</h:outputLink>
						</h:panelGroup>
						<h:panelGroup rendered="#{!editCAsMBean.renderLinkCertificate}">	
							<h:outputText value="#{web.text.RENEWCA_NOTAVAILABLE}" />
						</h:panelGroup>

					</h:panelGrid>
				</h:panelGroup>

                <!-- Activating a rollover certificate, i.e. a CA renewal certificate that has been imported for "nextCertSignKey"
                     so that CA renewal can start/and be executed while the CA is in operation. See SCEP draft 23, Appendix E:
                     https://tools.ietf.org/html/draft-nourse-scep-23#appendix-E -->
                <h:panelGroup rendered="#{editCAsMBean.editCA and editCAsMBean.rollOverDate}">
                    <h:outputText  value="#{web.text.CAROLLOVER}" />
                </h:panelGroup>
                <h:panelGroup rendered="#{editCAsMBean.editCA and editCAsMBean.rollOverDate}">
                    <h:outputText value="#{web.text.CACURRENTNOTAFTER}: " />
                    <h:outputText value="#{editCAsMBean.caNotAfter}" />
                    <br/>
                    <h:outputText value="#{web.text.CAROLLOVERNOTBEFORE}: " />
                    <h:outputText value="#{editCAsMBean.caRollOverNotBefore}" />
                    <br/>
                    <h:outputText value="#{web.text.CAROLLOVERNOTAFTER}: " />
                    <h:outputText value="#{editCAsMBean.caRollOverNotAfter}" />
                    <br/>
                    <h:commandButton name="buttonrollover"
                        value="#{web.text.CAROLLOVERBUTTON}"
                        onclick="#{editCAsMBean.confirmRolloverDate}"
                        action="#{editCAsMBean.rolloverCA}"/>
                </h:panelGroup>

				<h:panelGroup>
					<h:outputText  value="#{web.text.REPUBLISH}" />
				</h:panelGroup>
				<h:commandButton name="buttonpublishca"
					value="#{web.text.REPUBLISHCA}"
					rendered="#{editCAsMBean.renderRepublishCA}"
					action="#{editCAsMBean.publishCA}" />
			</h:panelGrid>

			<!-- ==================================================================== CA Life Cycle ================================================================================ -->

			<!-- ==================================================================== Externally signed CA creation/renewal ======================================================== -->
			<h:panelGrid columns="2" styleClass="edit-top lone-edit-heading"
				cellspacing="3" cellpadding="3" border="0" width="100%"
				rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2"
				rendered="#{editCAsMBean.renderExternallySignedCaCreationRenewal and not editCAsMBean.renderCvcAvailable}">
				<h:outputLabel for="externallysignedcacreaterenew"
					value="#{web.text.EXTERNALLYSIGNED_CA_CREATERENEW}"
					style="font-weight: bold;" />
				<h:panelGroup id="externallysignedcacreaterenew" />

				<h:panelGroup />

				<h:panelGroup>
					<h:panelGrid columns="2" columnClasses="column-editca,editColumn2">
						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<h:outputText value="#{web.text.EXTERNALLYSIGNED_STEP1}"
								style="font-weight: bold;" />
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.editCA}" />
						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<h:outputText value="#{web.text.EXTERNALLYSIGNED_NEXTKEY}" />
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<h:selectOneMenu name="selectcertsignkeyrenew"
								value="#{editCAsMBean.extrCertSignKeyReNewValue}">
								<f:selectItems value="#{editCAsMBean.extrAndCertSignKeyReNewList}" />
							</h:selectOneMenu>
						</h:panelGroup>
						<h:panelGroup>
							<h:outputLabel 
								value="#{web.text.EXTERNALLYSIGNED_CACHAIN}" />
							<br />
							<h:outputText value="#{web.text.EXTERNALLYSIGNED_CACHAIN_HELP}" styleClass="smallHelp" />
						</h:panelGroup>
						
						<h:panelGroup>
							<t:inputFileUpload name="filerecievefilemakerequest"
								align="right" value="#{editCAsMBean.fileRecieveFileMakeRequest}" />
						</h:panelGroup>
						<h:panelGroup />
						<h:panelGroup>
							<h:commandButton id="buttonmakerequest"
								value="#{web.text.MAKEREQUEST}"
								action="#{editCAsMBean.makeRequest}"
								disabled="#{!editCAsMBean.signedByExternal and !editCAsMBean.editCA or editCAsMBean.caUninitialized}" />
						</h:panelGroup>

						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<h:outputText value="#{web.text.EXTERNALLYSIGNED_STEP2}"
								style="font-weight: bold;" />
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.editCA}" />
						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<h:outputText value="#{web.text.EXTERNALLYSIGNED_CAKEY}" />
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<h:selectOneMenu name="selectcertsignkeyreceivereq"
								value="#{editCAsMBean.certSignKeyRecieveReqValue}">
								<f:selectItems value="#{editCAsMBean.certSignKeyRecieveReqList}" />
							</h:selectOneMenu>
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<h:outputText value="#{web.text.EXTERNALLYSIGNED_CACERT}" />
							<br />
							<h:outputText value="#{web.text.EXTERNALLYSIGNED_CACERT_HELP}" styleClass="smallHelp" />
						</h:panelGroup>
						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<t:inputFileUpload name="filerecievefilerecieverequest"
								value="#{editCAsMBean.fileRecieveFileRecieveRequest}" />
						</h:panelGroup>

						<h:panelGroup
							rendered="#{editCAsMBean.editCA and editCAsMBean.renderFutureRollOver}">
							<h:outputText
								value="#{web.text.EXTERNALLYSIGNED_FUTUREROLLOVER_HELP}"
								styleClass="smallHelp" />
						</h:panelGroup>
						<h:panelGroup
							rendered="#{editCAsMBean.editCA and editCAsMBean.renderFutureRollOver}">
							<h:selectBooleanCheckbox name="checkboxfuturerollover"
								id="checkboxfuturerollover"
								value="#{editCAsMBean.checkBoxFutureRollOver}"
								disabled="#{not editCAsMBean.hasEditRight}" />
							<h:outputText for="checkboxfuturerollover"
								value="#{web.text.EXTERNALLYSIGNED_FUTUREROLLOVER}" />
						</h:panelGroup>
						<h:panelGroup
							rendered="#{editCAsMBean.editCA and editCAsMBean.caInfoDto.caTypeX509}">
							<h:outputText
								value="#{web.text.EXTERNALLYSIGNED_CROSS_CERT_HELP}"
								styleClass="smallHelp" />
						</h:panelGroup>
						<h:panelGroup
							rendered="#{editCAsMBean.editCA and editCAsMBean.caInfoDto.caTypeX509}">
							<h:selectBooleanCheckbox name="checkboxuploadAsAlternateChain"
								id="checkboxuploadAsAlternateChain"
								value="#{editCAsMBean.uploadAsAlternateChain}"
								disabled="#{not editCAsMBean.hasEditRight}" />
							<h:outputText for="checkboxuploadAsAlternateChain"
								value="#{web.text.EXTERNALLYSIGNED_CROSS_CERT}" />
						</h:panelGroup>
						<h:panelGroup />
						<h:panelGroup rendered="#{editCAsMBean.editCA}">
							<h:commandButton name="buttonreceiverequest"
								value="#{web.text.RECIEVEREQUEST}"
								action="#{editCAsMBean.receiveResponse}" />
						</h:panelGroup>
					</h:panelGrid>
				</h:panelGroup>

			</h:panelGrid>

			<!-- ==================================================================== Externally signed CA creation/renewal ======================================================== -->

			<!-- ==================================================================== Import CA Renewal ============================================================================ -->

			<h:panelGrid columns="2" styleClass="edit-top lone-edit-heading"
				cellspacing="3" cellpadding="3" border="0" width="100%"
				rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2"
				rendered="#{editCAsMBean.editCA and editCAsMBean.caExternal and editCAsMBean.hasEditRight and not editCAsMBean.renderCvcAvailable and not editCAsMBean.caTypeProxy}">
				<h:outputLabel for="importcarenewal"
					value="#{web.text.IMPORTED_CA_RENEWAL}" style="font-weight: bold;" />
				<h:panelGroup id="importcarenewal" />
				<h:panelGroup />

				<h:panelGrid columns="2">
					<h:panelGroup>
						<h:outputText value="#{web.text.IMPORTED_CA_RENEWAL_NEWCERT}" />
						<br />
						<h:outputLabel
							value="#{web.text.IMPORTED_CA_RENEWAL_NEWCERT_HELP}" styleClass="smallHelp" />
					</h:panelGroup>
					<h:panelGroup>
						<t:inputFileUpload 
							name="filerecievefileimportrenewal" 
							value="#{editCAsMBean.fileRecieveFileImportRenewal}"/>
					</h:panelGroup>
					<h:panelGroup />
					<h:panelGroup>
						<h:commandButton 
							name="buttonreceiveimportrenewal"
							value="#{web.text.RECEIVE_IMPORT_RENEWAL}"
							action="#{editCAsMBean.importCACertUpdate}" />
					</h:panelGroup>
				</h:panelGrid>
			</h:panelGrid>

			<!-- ==================================================================== Import CA Renewal ============================================================================ -->

			<!-- ==================================================================== Proxy CA specific ============================================================================ -->
			<h:panelGrid id="proxyCa" columns="2" styleClass="edit-top lone-edit-heading"
						 cellspacing="3" cellpadding="3" border="0" width="100%"
						 rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2"
						 rendered="#{editCAsMBean.caTypeProxy}">
				<h:panelGroup>
					<h:outputLabel for="proxyCaTitle" value="#{web.text.PROXY_CATYPE}" style="font-weight: bold;" />
				</h:panelGroup>
				<h:panelGroup id="proxyCaTitle" />
				<h:panelGroup>
					<h:outputLabel for="textFieldUpstreamUrl" value="#{web.text.UPSTREAM_URL}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:inputText rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}" id="textFieldUpstreamUrl" name="upstreamUrl" size="45" maxlength="225"
								 value="#{editCAsMBean.caInfoDto.upstreamUrl}" title="#{web.text.UPSTREAM_URL}">
						<f:ajax />
						<!--<f:validator
								validatorId="org.ejbca.ui.web.admin.ca.validators.CvcSubjectDNValidator"
								disabled="#{not editCAsMBean.caInfoDto.caTypeCVC}" />-->
					</h:inputText>
					<h:outputText rendered="#{not (editCAsMBean.editCA and editCAsMBean.hasEditRight)}" 
												value="#{editCAsMBean.caInfoDto.upstreamUrl}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:outputLabel for="textFieldUsername" value="#{web.text.UPSTREAM_USERNAME}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:inputText id="textFieldUsername" name="username" size="25" maxlength="225"
								 value="#{editCAsMBean.caInfoDto.username}" title="#{web.text.UPSTREAM_USERNAME}"
								 rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}">
						<f:ajax />
					</h:inputText>
					<h:outputText rendered="#{not (editCAsMBean.editCA and editCAsMBean.hasEditRight)}" 
												value="#{editCAsMBean.caInfoDto.username}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:outputLabel for="textFieldPassword" value="#{web.text.UPSTREAM_PASSWORD}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:inputSecret id="textFieldPassword" name="password" size="25" maxlength="225" redisplay="true"
								autocomplete="off" rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}"
								 value="#{editCAsMBean.upstreamPassword}" title="#{web.text.UPSTREAM_PASSWORD}">
						<f:ajax />
					</h:inputSecret>
					<h:outputText rendered="#{not (editCAsMBean.editCA and editCAsMBean.hasEditRight)}" 
												value="********" />
				</h:panelGroup>
				<h:panelGroup>
					<h:outputLabel for="headersTitle" value="#{web.text.UPSTREAM_HEADERS}" style="font-weight: bold;" />
				</h:panelGroup>

				<h:panelGroup id="headersTitle" />
				<c:forEach items="#{editCAsMBean.caInfoDto.headers}" var="header" varStatus="loopStatus">
					<h:panelGroup id="wrapperHeaderKey-#{loopStatus.index}">
						<h:selectBooleanCheckbox
								id="removeHeaderCheckBox-#{loopStatus.index}"
								value="#{header.left}"
								rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}">
							<f:ajax />
						</h:selectBooleanCheckbox>
					</h:panelGroup>
					<h:panelGroup id="wrapperHeaderValue-#{loopStatus.index}">
						<h:inputText id="textFieldHeaderKey-#{loopStatus.index}" name="textFieldHeaderKey-#{status.index}" size="25" maxlength="225"
									 value="#{header.middle}" title="#{web.text.HEADER_FIELD_KEY}"
									 rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}">
							<f:ajax />
						</h:inputText>
						<h:outputText rendered="#{not (editCAsMBean.editCA and editCAsMBean.hasEditRight)}" 
												value="#{header.middle}" />
						<h:outputText id="headerSeparator-#{loopStatus.index}" value=" : "/>
						<h:inputText id="textFieldHeaderValue-#{loopStatus.index}" name="textFieldHeaderValue-#{status.index}" size="25" maxlength="225"
									 value="#{header.right}" title="#{web.text.HEADER_FIELD_VALUE}"
									 rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}">
							<f:ajax />
						</h:inputText>
						<h:outputText rendered="#{not (editCAsMBean.editCA and editCAsMBean.hasEditRight)}" 
												value="#{header.right}" />
					</h:panelGroup>
				</c:forEach>
				<h:panelGroup id="addHeaderTitle" rendered="#{not editCAsMBean.hasAnyHeader}" />
				<h:commandButton id="removeHeaderButton"
								 value="#{web.text.REMOVE}"
								 action="#{editCAsMBean.removeHeader}"
								 rendered="#{editCAsMBean.hasAnyHeader and editCAsMBean.editCA and editCAsMBean.hasEditRight}">
					<f:ajax render="proxyCa" />
				</h:commandButton>
				<h:commandButton id="addHeaderButton"
								 value="#{web.text.ADD}"
								 action="#{editCAsMBean.addBlankHeader}"
								 rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}">
					<f:ajax render="proxyCa" />
				</h:commandButton>
				<h:panelGroup>
					<h:outputLabel for="textFieldCertificateAuthority" value="#{web.text.CERTIFICATE_AUTHORITY}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:inputText id="textFieldCertificateAuthority" name="certificateAuthority" size="25" maxlength="225"
								 value="#{editCAsMBean.caInfoDto.upstreamCa}" title="#{web.text.CERTIFICATE_AUTHORITY}"
								 rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}">
						<f:ajax />
					</h:inputText>
					<h:outputText rendered="#{not (editCAsMBean.editCA and editCAsMBean.hasEditRight)}" 
												value="#{editCAsMBean.caInfoDto.upstreamCa}" />
					<br/>
					<h:outputText styleClass="smallHelp" value="#{web.text.UPSTREAM_CA_HELP}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:outputLabel for="textFieldTemplate" value="#{web.text.TEMPLATE}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:inputText id="textFieldTemplate" name="certificateAuthority" size="25" maxlength="225"
								 value="#{editCAsMBean.caInfoDto.upstreamTemplate}" title="#{web.text.TEMPLATE}"
								 rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}">
						<f:ajax />
					</h:inputText>
					<h:outputText rendered="#{not (editCAsMBean.editCA and editCAsMBean.hasEditRight)}" 
												value="#{editCAsMBean.caInfoDto.upstreamTemplate}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:outputLabel for="textAreaSans" value="#{web.text.SANS}" />
				</h:panelGroup>
				<h:panelGroup>
					<h:inputTextarea id="textAreaSans" rows="4" cols="38" 
							value="#{editCAsMBean.caInfoDto.sansJson}"
							rendered="#{editCAsMBean.editCA and editCAsMBean.hasEditRight}">
						<f:ajax />
					</h:inputTextarea>
					<h:outputText rendered="#{not (editCAsMBean.editCA and editCAsMBean.hasEditRight)}" 
												value="#{editCAsMBean.caInfoDto.sansJson}" />
					<br/>
					<h:outputText styleClass="smallHelp" value="#{web.text.SANS_HELP}" />
				</h:panelGroup>



			</h:panelGrid>
			<!-- ==================================================================== Proxy CA specific ============================================================================ -->

			<!-- ==================================================================== Form buttons  ================================================================================ -->
			<h:panelGrid columns="2" styleClass="edit-top lone-edit-heading"
				cellspacing="3" cellpadding="3" border="0" width="100%"
				rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2"
				rendered="#{not editCAsMBean.renderCvcAvailable}">
				<h:outputLabel />

				<h:panelGroup rendered="#{not editCAsMBean.caExternal}">

					<h:commandButton id="buttonsave"
						value="#{web.text.SAVE}"
						action="#{editCAsMBean.saveCa}"
						rendered="#{editCAsMBean.editCaNotUninitializedHasEditRights}" />
						
					<h:commandButton name="buttonsave"
						value="#{web.text.SAVE}"
						rendered="#{editCAsMBean.editCaUninitializedHasEditRights and editCAsMBean.cryptoTokenIdParamNotNull}"
						action="#{editCAsMBean.saveCa}" />
												
					<h:commandButton id="buttoninitialize"
						value="#{web.text.SAVE_AND_INITIALIZE}"
						rendered="#{editCAsMBean.editCaUninitializedHasEditRights and editCAsMBean.cryptoTokenIdParamNotNull}"
						action="#{editCAsMBean.initializeCa}" />

					<h:outputText
						value="#{web.text.CRYPTOTOKEN_DOESNT_EXIST_CANT_INITIALIZE}"
						style="font-weight: bold;"
						rendered="#{editCAsMBean.editCaUninitializedHasEditRights and not editCAsMBean.cryptoTokenIdParamNotNull and editCAsMBean.caUninitialized}" />
					<ui:fragment 
						rendered="#{editCAsMBean.editCaUninitializedHasEditRights and not editCAsMBean.cryptoTokenIdParamNotNull and editCAsMBean.caUninitialized}">
						<br />
						<br />
					</ui:fragment>

					<h:commandButton name="buttonsave"
						value="#{web.text.SAVE}"
						action="#{editCAsMBean.saveCa}"
						rendered="#{editCAsMBean.editCaUninitializedHasEditRights and not editCAsMBean.cryptoTokenIdParamNotNull and editCAsMBean.caUninitialized}" />

					<h:outputText
						value="#{web.text.CRYPTOTOKEN_DOESNT_EXIST_CANT_SAVE}"
						style="font-weight: bold;"
						rendered="#{editCAsMBean.editCaUninitializedHasEditRights and not editCAsMBean.cryptoTokenIdParamNotNull and not editCAsMBean.caUninitialized}" />

					<h:commandButton id="buttoncreate"
						value="#{web.text.CREATE}"
						action="#{editCAsMBean.createCa}"
						rendered="#{not editCAsMBean.editCA and editCAsMBean.hasEditRight and editCAsMBean.hasCreateRight}"
						disabled="#{editCAsMBean.signedByExternal}" />
        	    &nbsp;&nbsp;&nbsp;
				<h:button 
						name="buttoncancel"
						value="#{web.text.CANCEL}"
						outcome="managecas.xhtml?faces-redirect=true"  />

				</h:panelGroup>

				<h:panelGroup rendered="#{editCAsMBean.caExternal}">
					<h:commandButton name="buttonsaveexternalca"
						value="#{web.text.SAVE}"
						rendered="#{editCAsMBean.renderSaveExternalCa}"
						action="#{editCAsMBean.saveExternalCA}" />
				&nbsp;&nbsp;&nbsp;
				<h:button name="buttoncancel" value="#{web.text.CANCEL}"
						rendered="#{editCAsMBean.renderSaveExternalCa}"
						outcome="managecas.xhtml?faces-redirect=true" />
					<h:button name="buttoncancel" value="#{web.text.BACK}"
						rendered="#{not editCAsMBean.renderSaveExternalCa}" 
						outcome="managecas.xhtml?faces-redirect=true" />
				</h:panelGroup>

			</h:panelGrid>
			</h:form>

		<!-- ==================================================================== Form Buttons (End Of CA Form)  =============================================================== -->

		<!-- ==================================================================== Export CA Header  ============================================================================ -->
		<h:form prependId="false">
			<h:panelGrid columns="2" styleClass="edit-top lone-edit-heading"
				cellspacing="3" cellpadding="3" border="0" width="100%"
				rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2"
				rendered="#{editCAsMBean.editCA and not editCAsMBean.caExternal and editCAsMBean.hasEditRight and not editCAsMBean.renderCvcAvailable}">
				<h:outputLabel for="exportcaheader"
					value="#{web.text.EXPORTCA_HEADER}" style="font-weight: bold;" />
				<h:panelGroup id="exportcaheader" />
				<h:panelGroup />

				<h:panelGroup rendered="#{editCAsMBean.caExportable}">
					<h:outputText value="#{web.text.EXPORTCA_AUTHCODE}" />
					<h:inputSecret autocomplete="off" id="#{editCAsMBean.textFieldExportCaPassword}" required="true" label="Password is required for exporting CA!" />
					<h:commandButton name="buttonexportca"
						value="#{web.text.EXPORTCA} ..." 
						action="#{editCAsMBean.exportCA}">
						<f:param name="#{editCAsMBean.hiddenCaName}" value="#{editCAsMBean.caName}"/>
					</h:commandButton>	
				</h:panelGroup>
				<h:panelGroup rendered="#{not editCAsMBean.caExportable}">
					<h:outputText value="#{web.text.EXPORTCA_NA}" />
				</h:panelGroup>
			</h:panelGrid>
		</h:form>

		<!-- ==================================================================== Export CA Header  ============================================================================ -->

	</ui:define>
</ui:composition>
</html>
