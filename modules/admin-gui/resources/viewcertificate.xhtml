<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets">

<ui:remove>
    <!--
    /*************************************************************************
     *                                                                       *
     *  EJBCA: The OpenSource Certificate Authority                          *
     *                                                                       *
     *  This software is free software; you can redistribute it and/or       *
     *  modify it under the terms of the GNU Lesser General Public           *
     *  License as published by the Free Software Foundation; either         *
     *  version 2.1 of the License, or any later version.                    *
     *                                                                       *
     *  See terms of license at gnu.org.                                     *
     *                                                                       *
     *************************************************************************/
     
     $Id: viewcainfo.xhtml 30542 2018-11-19 13:35:45Z tarmor $
     -->
</ui:remove>

<f:metadata> 
    <f:event type="preRenderView" listener="#{viewCertificateMBean.initialize}"/> 
</f:metadata>

<ui:composition template="/WEB-INF/include/popup.xhtml">
    <ui:define name="content">
        <h2>
            <h:outputText value="#{web.text.VIEW_CACERTIFICATE_HEADING}" rendered="#{viewCertificateMBean.cacerts}" />
            <h:outputText value="#{web.text.VIEW_CERTIFICATES_HEADING}" rendered="#{!viewCertificateMBean.cacerts}" />
        </h2>
        
        <h:form id="viewcertificate">
            <h:panelGrid columns="2" styleClass="view-top" cellspacing="2" cellpadding="0" border="0" width="100%" rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2">
                <h:panelGroup>
                    <strong><h:outputLabel value="#{web.text.USERNAME}"/></strong>
                </h:panelGroup>
                <h:panelGroup>
                    <strong><h:outputLabel value="#{viewCertificateMBean.certificateData.username}"/></strong>
                </h:panelGroup>
                
                <h:panelGroup>
                    <strong><h:outputLabel value="#{web.text.CANAME}"/></strong>
                </h:panelGroup>
                <h:panelGroup>
                    <strong><h:outputLabel value="#{viewCertificateMBean.caName}"/></strong>
                    <h:outputLabel value=" (#{viewCertificateMBean.caId})"/>
                </h:panelGroup>
  
                <ui:remove>              
                <!-- Index -->
                </ui:remove>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.HARDTOKENSN}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.tokenSn}"/>
                </h:panelGroup>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.CERTIFICATENR}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.nextIndex} #{web.text.OF} #{viewCertificateMBean.numberOfCertificates}"/>
                </h:panelGroup>
                
                <ui:remove>
                <!-- Certificate content -->
                </ui:remove>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.CERT_TYPEVERSION}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.certificateData.type} #{web.text.VER} #{viewCertificateMBean.certificateData.version}"/>
                </h:panelGroup>

                <h:panelGroup>
                    <h:outputLabel value="#{web.text.CERT_SERIALNUMBER}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.formattedCertSn}"/>
                </h:panelGroup>

                <h:panelGroup>
                    <h:outputLabel value="#{web.text.CERT_ISSUERDN}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.issuerDnUnescaped}"/>
                </h:panelGroup>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.CERT_VALIDFROM}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.certificateData.validFromString}"/>
                </h:panelGroup>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.CERT_VALIDTO}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.certificateData.validToString}"/>
                </h:panelGroup>
                
                <h:panelGroup>
                    <strong><h:outputLabel value="#{web.text.CERT_SUBJECTDN}"/></strong>
                </h:panelGroup>
                <h:panelGroup>
                    <strong><h:outputLabel value="#{viewCertificateMBean.subjectDnUnescaped}"/></strong>
                </h:panelGroup>
                
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{web.text.EXT_ABBR_SUBJECTALTNAME}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{viewCertificateMBean.subjectAltName}"/>
                </h:panelGroup>
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{web.text.EXT_ABBR_SUBJECTDIRATTRS}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{viewCertificateMBean.subjectDirAttributes}"/>
                </h:panelGroup>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.CERT_PUBLICKEY}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.publicKey}"/>
                </h:panelGroup>
            
            </h:panelGrid>    
            <h:panelGrid columns="2" styleClass="view-top" cellspacing="2" cellpadding="0" border="0" width="100%" rowClasses="Row0,Row1" columnClasses="editColumn1,editColumn2">
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <strong><h:outputLabel value="#{web.text.EXT_ABBR_BASICCONSTRAINTS}" styleClass="title"/></strong>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <strong><h:outputLabel value="#{viewCertificateMBean.basicConstraints}"/></strong>
                </h:panelGroup>
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{web.text.EXT_ABBR_KEYUSAGE}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{viewCertificateMBean.keyUsage}"/>
                </h:panelGroup>
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{web.text.EXT_ABBR_EXTENDEDKEYUSAGE}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{viewCertificateMBean.extendedKeyUsage}"/>
                </h:panelGroup>
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{web.text.EXT_ABBR_NAMECONSTRAINTS}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{viewCertificateMBean.hasNameConstraints ? web.text.YES : web.text.NO}"/>
                </h:panelGroup>
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{web.text.EXT_ABBR_AUTHORITYINFOACCESS}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{viewCertificateMBean.authorityInfoAccess}"/>
                </h:panelGroup>
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{web.text.EXT_ABBR_QCSTATEMENTS}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{viewCertificateMBean.qcStatement ? web.text.YES : web.text.NO}"/>
                </h:panelGroup>
                
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{web.text.EXT_CERTIFICATE_TRANSPARENCY_SCTS}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!viewCertificateMBean.isCvc}">
                    <h:outputLabel value="#{viewCertificateMBean.certificateTransparencySCTs ? web.text.YES : web.text.NO}"/>
                </h:panelGroup>
                
                
                <ui:remove>
                    <!-- TODO:  !certificatedata.getType().equalsIgnoreCase("CVC")  condition ends here. implement!-->
                </ui:remove>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.SIGNATUREALGORITHM}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.certificateData.signatureAlgoritm}"/>
                </h:panelGroup>
                
                <ui:remove>
                    <!-- Certificate information -->
                </ui:remove>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.FINGERPRINT_SHA256}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.fingerPrint}" styleClass="fingerprint"/>
                </h:panelGroup>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.FINGERPRINT_SHA1}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel styleClass="fingerprint" value="#{viewCertificateMBean.certificateData.SHA1Fingerprint}"/>
                </h:panelGroup>
                
                <h:panelGroup>
                    <h:outputLabel value="#{web.text.REVOKED}"/>
                </h:panelGroup>
                <h:panelGroup>
                    <h:outputLabel value="#{viewCertificateMBean.certificateData.revoked}"/>
                </h:panelGroup>
            </h:panelGrid>
        </h:form>
    </ui:define>
</ui:composition>
</html>
