<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-15"
 http-equiv="content-type">
  <title>Managing Certificates in Internet Explorer</title>
  <meta content="James A. Rome" name="author">
</head>
<body>
<h1 style="text-align: center; color: rgb(0, 102, 0);">SensorNet and
Digital
Certificates:</h1>
<h1 style="text-align: center; color: rgb(0, 0, 153);">Managing
Certificates In Internet Explorer</h1>
<br>
<table style="text-align: left; width: 923px; height: 5788px;"
 border="0" cellpadding="2" cellspacing="2">
  <tbody>
    <tr>
      <td style="vertical-align: top;">This howto was contributed to the EJBCA project by SensorNet. <br>
      <ul>
      <li>For more information about EJBCA, visit <a href="http://www.ejbca.org/">ejbca.org</a>.</li>
      <li><a href="https://www.primekey.se/">PrimeKey</a> are the Developers behind EJBCA, and offers turn-key <a href="https://www.primekey.se/technologies/products-overview/pki-appliance/">PKI Appliance</a> and professional support offering around <a href="https://www.primekey.se/technologies/products-overview/ejbca-enterprise/">EJBCA Enterprise</a>.</li>
      </ul>
      <hr>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Internet Explorer (IE) stores
certificates for all Microsoft applications because they all share the
same security context. This architecture means that a flaw in Internet
Explorer affects all of Windows, and vice versa. Therefore, if you
choose to use Internet Explorer for browsing, you must be extra careful
to keep your PC secure. We strongly recommend that you consider the
much more modern and secure Mozilla browser. You will be glad that you
did.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">
      <h2>Contents</h2>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">
      <ul>
        <li>
          <h3><a href="#Accessing_your_certificates">Accessing
certificates</a></h3>
        </li>
        <li>
          <h3><a href="#Exporting_your_certificate_and_keys">Exporting
certificates</a></h3>
        </li>
        <li>
          <h3><a href="#Trusting_the_SensorNetCA">Trusting the
Certificate Authority</a></h3>
        </li>
        <li>
          <h3><a href="#Importing_your_certificate_and_keys">Importing
certificates</a></h3>
        </li>
      </ul>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr
 style="font-family: Helvetica,Arial,sans-serif; color: rgb(0, 102, 0);">
      <td style="vertical-align: top;">
      <h3><a name="Accessing_your_certificates"></a>Accessing your
certificates</h3>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">To access your certificate cache
in IE, in the <span style="font-weight: bold;">Tools </span>menu,
select <span style="font-weight: bold;">Internet Options</span> and
then the <span style="font-weight: bold;">Content</span> tab (Figure
1).<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr align="center">
      <td style="vertical-align: top;"><img
 style="width: 535px; height: 546px;" alt="Content Manu"
 src="IEInternetOptions.png"><br>
      <span style="font-weight: bold;">Figure 1.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Click the certificates tab to
display your certificate store (Figure 2).<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 590px; height: 561px;" alt="IE Certificate store"
 src="IECertificates.png"><br>
      <span style="font-weight: bold;">Figure 2.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr
 style="font-family: Helvetica,Arial,sans-serif; color: rgb(0, 102, 0);">
      <td style="vertical-align: top;">
      <h3><a name="Exporting_your_certificate_and_keys"></a>Exporting
your certificate and keys</h3>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">The first thing you want to do
is to export your certificate so that it is backed up in a safe place,
and also so that you can then import it into other browsers on this or
other computers. Select you identity as shown above and click the <span
 style="font-weight: bold;">Export </span>button. The Certificate
Export Wizard will appear (Figure 3).<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">
      <div style="text-align: center;"><img
 style="width: 586px; height: 467px;" alt="Certificate export wizard"
 src="IECertExport1.png"><br>
      </div>
      <div style="text-align: center;"><span style="font-weight: bold;">Figure
3.</span><br>
      </div>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Click <span
 style="font-weight: bold;">Next</span>, and then choose to <span
 style="font-weight: bold;">export the private key</span> (Figure 4).
Without the private key, the certificate is only useful to others.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 583px; height: 465px;" alt="Export the private key"
 src="IECertExport2.png"><br>
      <span style="font-weight: bold;">Figure 4.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Click <span
 style="font-weight: bold;">Next</span>, and the <span
 style="font-weight: bold;">Export File Format</span> screen will
appear (Figure 5).&nbsp; Make the selections shown below. The PKCS #12
format is the standard format understood by other browsers. Include the
certificates in the path so that the SensorNetCA certificate will be
included in the export. For sure, enable strong protection. Without
that, your private key will be unprotected.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 581px; height: 467px;" alt="Export file format"
 src="IECertExport3.png"><br>
      <span style="font-weight: bold;">Figure 5.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Because you enabled strong
protection, a password box will appear when you click <span
 style="font-weight: bold;">Next </span>as shown in Figure 6. Be sure
to choose a good password -- at least 8 characters including letters,
numbers, and special characters with no dictionary words.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 585px; height: 466px;" alt="password"
 src="IECertExport4.png"><br>
      <span style="font-weight: bold;">Figure 6.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Choose the file name for the
exported key (Figure 7). I always make a special directory on my hard
disk (and protect it so that only I have access) to store my keys in.
Unfortunately, Microsoft insists on using the ".pfx" file extension for
this rather than the more universal ".p12".<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 584px; height: 467px;" alt="export file name"
 src="IECertExport5.png"><br>
      <span style="font-weight: bold;">Figure 7.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">You then get a chance to review
your choices in the final screen of the Wizard (Figure 8).<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 585px; height: 464px;" alt="Final review"
 src="IECertExport6.png"><br>
      <span style="font-weight: bold;">Figure 8.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">When you click Finish, you will
get a pop-up asking for your CryptoAPI Private Key (Figure 9). This is
the password you originally used to protect the certificate when you
obtained it from the SensorNetCA. <span style="font-weight: bold;">Never
      </span>check the "Remember password" box.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 511px; height: 327px;" alt="CryptoAPI key"
 src="CryptoAPIKey.png"><br>
      <span style="font-weight: bold;">Figure 9.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Finally you are done! <span
 style="font-weight: bold; font-style: italic;">Be sure to copy your
exported certificate to a floppy or a CD</span> so that it is stored
off of your computer in case you need to rebuild it, loose a hard
drive, etc. Go look at the instructions for Mozilla to see how much
easier this is.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr
 style="font-family: Helvetica,Arial,sans-serif; color: rgb(0, 102, 0);">
      <td style="vertical-align: top;">
      <h3><a name="Trusting_the_SensorNetCA"></a>Trusting the
SensorNetCA</h3>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">The next thing to do is to make
sure that you trust the SensorNet Certificate Authority. Start at the
screen in Figure 2 and select the <span style="font-weight: bold;">Trusted
Root Certification</span> <span style="font-weight: bold;">Authorities</span>
Tab. You might have to scroll the horizontal arrows near the top-right
of the dialog in order to access this tab.&nbsp; You should be able to
find the SensorNetCA listed (Figure 10). The SensorNetCA certificate
should have been imported automatically when you obtained your
SensorNet Certificate.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 590px; height: 563px;" alt="Trusted root CA"
 src="IETrustedRootTab.png"><br>
      <span style="font-weight: bold;">Figure 10.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><a name="Manual_Import"></a>In
case you cannot find the
SensorNetCA listed, you will have to import it manually into IE. To do
this, go to <a
 href="https://ca.sensornet.org:8442/ejbca/publicweb/webdist/index.html">https://ca.sensornet.org:8442/ejbca/publicweb/webdist/index.html</a>
to access the SensorNet certificate retrieval page (Figure 11). Click
the "Fetch CA and OSCP certificates" link.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 790px; height: 912px;" alt="Certificate retrieval page"
 src="CertRetrievalPage.png"><br>
      <span style="font-weight: bold;">Figure 11.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Click the link blue link in
Figure 12 for Internet Explorer to import the SensorNet CA certificate.
The OSCP responder certificate allows your browser to check the
validity of certificates whenever they are used. However, you can only
choose one OSCP responder, so unless SensorNet is the only secure site
you use, do not get the OSCPResponder certificate.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 789px; height: 468px;" alt="Fetch CA certificate"
 src="FetchCACert.png"><br>
      <span style="font-weight: bold;">Figure 12.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">When the Import Certificate
Wizard comes up, be sure to select the certificate store manually.
Choost the Trusted Root Certification Authorities store. Then return to
Figure 10 and find the SensorNetCA certificate.&nbsp;
Click the <span style="font-weight: bold;">Advanced </span>button to
display the purposes for which you trust this certificate (Figure 13).
They are probably all checked by default, but if not, make sure you
check them all. This is not a very good situation because trust should
not be enabled by default!<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 446px; height: 458px;" alt="Trusted uses"
 src="CAAdvanced.png"><br>
      <span style="font-weight: bold;">Figure 13.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr
 style="font-family: Helvetica,Arial,sans-serif; color: rgb(0, 102, 0);">
      <td style="vertical-align: top;">
      <h3><a name="Importing_your_certificate_and_keys"></a>Importing
your certificate and keys</h3>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Start from Figure 2 and click
the <span style="font-weight: bold;">Import </span>button. The Import
Certificate Wizard will appear (Figure 14).<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 583px; height: 466px;" alt="Import wizard"
 src="IECertImport1.png"><br>
      <span style="font-weight: bold;">Figure 14.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">You must then find the file for
the certificate you wish to import (Figure 15). In the browse file
selection window, you may need to change the file selection type to see
the different certificate types that can be imported (Figure 16)<br>
      <br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 585px; height: 465px;" alt="Finding the certificate"
 src="IECertImport2.png"><br>
      <span style="font-weight: bold;">Figure 15.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 327px; height: 138px;" alt="File types"
 src="IEImportFileTypes.png"><br>
      <span style="font-weight: bold;">Figure 16.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Clicking Next will bring up a
password dialog (Figure 17). This is the password you used when you
exported the certificate in Figure 6.&nbsp; Be sure to check the boxes
to enable strong protection and to mark the key as exportable. It is
unfortunate that every default chosen by Microsoft leads to the lowest
level of security possible, so you must continually override their bad
intentions.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 583px; height: 468px;" alt="certificate password"
 src="IECertImport3.png"><br>
      <span style="font-weight: bold;">Figure 17.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">The next screen allows you to
choose the key store for the certificate. If it is one of your
certificates, use the default personal store. Otherwise, select one of
the choices from the pop-up launched by the Browse button (Figure 18).
If unsure, select the automatic radio button.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 580px; height: 550px;" alt="Import store"
 src="IECertImport4.png"><br>
      <span style="font-weight: bold;">Figure 18.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Finally, the Wizard completion
screen appears (Figure 19). But once again, Microsoft firces you to set
the security to a higher level.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 587px; height: 468px;" alt="Finished!"
 src="IECertImport5.png"><br>
      <span style="font-weight: bold;">Figure 19.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">The "Importing a new private
exchange key" pop-up appears with the security level set to Medium
(Figure 20).<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 515px; height: 330px;" alt="New protected item"
 src="IENewProtectedItem.png"><br>
      <span style="font-weight: bold;">Figure 20.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Just as you did when you
originally got your SensorNet certificate, click the "<span
 style="font-weight: bold;">Set Security Level</span>" button and
select "<span style="font-weight: bold;">High</span>" in Figure 21.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top; text-align: center;"><img
 style="width: 589px; height: 393px;" alt="Select High protection"
 src="IEImportHigh.png"><br>
      <span style="font-weight: bold;">Figure 21.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">Again you will be asked for a
password to protect this item. It is the one for the CryptoAPIKey you
used in Figure 9. You should then (finally!) see the Figure 20 with the
secutity Level set to High.&nbsp; Click OK, and the certificate will
appear in your cache.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
  </tbody>
</table>
<br>
<!-- Piwik -->
<script type="text/javascript">
var pkBaseURL = (("https:" == document.location.protocol) ? "https://stat.primekey.se/piwik/" : "http://stat.primekey.se/piwik/");
document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
</script><script type="text/javascript">
try {
var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 5);
piwikTracker.trackPageView();
piwikTracker.enableLinkTracking();
} catch( err ) {}
</script><noscript><p><img src="//stat.primekey.se/piwik/piwik.php?idsite=5" style="border:0" alt=""></p></noscript>
<!-- End Piwik Tracking Code -->
</body>
</html>
