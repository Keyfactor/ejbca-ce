<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-15"
 http-equiv="content-type">
  <title>Secure E-mail using Outlook</title>
  <meta content="James A. Rome" name="author">
</head>
<body>
<h2 style="text-align: center;"><span style="color: rgb(0, 102, 0);">SensorNet
and Digital Certificates:</span><br>
<span style="color: rgb(0, 0, 153);">Using Secure E-mail with Microsoft
Outlook 2003</span> </h2>
<br>
<ul>
  <li><a
 href="#getcert">Retrieving
Other People's Digital Certificates</a> </li>
  <li><a
 href="#encryption">Encrypting
Email</a> </li>
  <li><a
 href="#signing">Digitally
Signing Email</a> </li>
  <li><a
 href="#both">Encrypting
and Digitally Signing Email </a></li>
</ul>

<a name="getcert"></a>
<b>Retrieving Other People's Digital Certificates
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td> By now, you probably know that in order to send secure
(specifically, encrypted) email to a SensorNet individual, you will
need their public key (contained within their digital certificate). How
do you get their public key? Well, at SensorNet we store people's
certificates in our online directory (LDAP). You can easily retrieve
their certificates via the directory and place them into your computer.
Listed below are the steps on how to do this. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> First, we're going to make a new directory for Outlook. On
the top menubar, go to "<b>Tools</b>" and then "<b>E-mail Accounts</b>"
(see
Figure 1). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 756px; height: 640px;"
 alt="Outlook toolbar" src="outlooktoolbar.gif"><br>
      <b>Figure 1.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td> In this new window, click on the "<b>Directory Service</b>"
tab on top, and then click on the "<b>Add</b>" button at the top right
hand corner of the window. Choose "<b>Directory Service</b>". (See
Figure 2) </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 667px; height: 523px;"
 alt="Creating a directory" src="outlookdirectory1.gif"><br>
      <b>Figure 2.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td style="text-align: center;">&nbsp;<img
 style="width: 670px; height: 522px;" alt="Select LDAP"
 src="outlookdirectory1a.gif"><br>
      <span style="font-weight: bold;">Figure 2a.</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td> You'll now be instructed to enter various bits of
information on different screens. On the first screen, type in "<b>ldap.sensornet.gov</b>"
for the "<b>Internet directory (LDAP) server</b>" field. Click on "<b>Next</b>"
when you finished (see Figure 3). When the wizard finishes, you will
have to restart Outlook.<br>
      </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 662px; height: 518px;"
 alt="Directory Wizard" src="outlookdirectservname.gif"><br>
      <b>Figure 3.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>Click the "More Settings..." button. The SensorNet
LDAP listens on an SSL connection on port 636, so check the SSL box and
use port 636
(see Figure 4). Also enter SensorNet LDAP for the display name. Also
the the search base to "<span style="font-weight: bold;">dc=sensornet,dc=gov</span>"
with no spaces. <br>
      </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center">
      <div style="text-align: center;"> </div>
      <table style="width: 100%; text-align: left;" border="0"
 cellpadding="2" cellspacing="2">
        <tbody>
          <tr>
            <td style="vertical-align: top; text-align: center;"><img
 style="width: 403px; height: 422px;" alt="Advanced settings"
 src="LDAP%20advanced%20settings.png"></td>
            <td style="vertical-align: top; text-align: center;"><img
 style="width: 403px; height: 423px;" alt="Base DN" src="basedn.png"></td>
          </tr>
        </tbody>
      </table>
      <br>
      <b>Figure 4.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> You will now be at a window which confirms that you have
successfully entered in all of your information. Click on "<b>Finish</b>"
(see Figure 5). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 669px; height: 522px;"
 alt="Congratulations" src="outlookcongrats.gif"><br>
      <b>Figure 5.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>You must restart Outlook to use this new LDAP. <br>
If you open the address book (in the tools menu) you will see the
SensorNet LDAP&nbsp; as an available source as ilustrated by <b>Figure
6</b>. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 481px; height: 410px;"
 alt="Address book sources" src="outlookadresssources.png"><br>
      <b>Figure 6.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Now we have to set up Outlook to use digital certificates.
Go to "<b>Tools | Options</b>" from the top menubar. Select "<b>Security</b>"
from the tabs, and then click on the "<b>Settings</b>" button.
You should then see a new window illustrated by Figure 7. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 505px; height: 587px;"
 alt="Security settings" src="outlooksecurity.gif"><br>
      <b>Figure 7.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> At this window, enter any name you wish for the "<b>Security
Settings Name</b>", and for the "<b>Secure Message Format</b>", choose "<b>S/MIME</b>".
In the "<b>Signing Certificate"</b> box, click "<b>Choose</b>", and
then choose your digital certificate (if it has been installed). Repeat
for the "<b>Encryption Certificate</b>" box. Finally, select the "<b>Send
these certificates with signed messages</b>" checkbox. Press "<b>OK</b>"
when done. </td>
    </tr>
  </tbody>
</table>
<b><br>
<a name="search"></a>
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td> Now we can search for people's digital certificates at
SensorNet. On the main menubar, click on "<b>Tools | Address Book</b>".
In
the Address Book window, click on the "<b>Find People</b>" button. You
should now be a window that looks like the one illustrated by Figure 8.
      </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 504px; height: 407px;"
 alt="Find people" src="outlookfindpeople.gif"><br>
      <b>Figure 8.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Make sure that the SensorNet directory that you specified
above
is in the "<b>Show names from the:</b>" drop-down menu. Now, supply
either the name
or the email address of the recipient to whom you wish to send
encrypted email, and click on the "<b>Find Now</b>" button. You'll see
the entry (or entries) show up in the lower half of the window.
Highlight the desired entry, and then click on the "<b>Properties</b>
button. You'll see another window pop up, which should look like the
one illustrated by Figure 9. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 775px; height: 639px;"
 alt="User properties" src="outlookcontactproperties2.gif"><br>
      <b>Figure 9.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Click on the "<b>Add to Contacts</b>" button (second from
right), or right-click the name and select "<span
 style="font-weight: bold;">Add to contacts</span>", and then select
the "<b>Certificates</b>" tab at
the top. If you see any listings for the person(s) you searched, it
means that you are able to send encrypted email to them! (See Figure
10) </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 775px; height: 641px;"
 alt="user certificate properties" src="outlookcert_properties.gif"><br>
      <b>Figure 10.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td style="vertical-align: top;">If you click the properties
button on the certificate page, you can see the contents of the
certificate (Figure 11). The default trust for the certificate (and you
must trust it to use it) is that it inherits its trust from the issuing
Certificate Authority, so be sure to visit the SensorNet CA page and
import the certificate into your Internet Explorer. IE stores all the
CA certificates for Windows,<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">
      <table style="width: 100%; text-align: left;" border="1"
 cellpadding="2" cellspacing="2">
        <tbody>
          <tr align="center">
            <td style="vertical-align: top;"><img
 style="width: 542px; height: 576px;" alt="Certificate properties"
 src="outlookcert_properties1.gif"><br>
            </td>
          </tr>
          <tr align="center">
            <td style="vertical-align: top;"><img
 style="width: 541px; height: 573px;" alt="Certificate trust"
 src="outlookcert_properties2.gif"><br>
            <span style="font-weight: bold;">Figure 11.</span><br>
            </td>
          </tr>
        </tbody>
      </table>
      <br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td> Congratulations! The person's digital certificate has been
imported to your computer. You can now send this person encrypted
email.&nbsp;<br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 204, 153);">If
you had used Mozilla or Netscape 7x, it would not be necessary to
manually import a certificate into your address book in order to send
the user e-mail. They are smart enough to go to the LDAP and find the
certificate for you, and also import it into your address book.<br>
      </td>
    </tr>
  </tbody>
</table>
<b><br>
<a name="alt"></a>
</b>
<table alt="center" border="0">
  <tbody>
    <tr>
      <td><i>An Alternate Method...</i><br>
      <br>
There is also another method of retrieving a person's digital
certificate. Anyone who sends you a digitally signed email will already
have their public key automatically associated with their address. Open
up the message and right-click on the person's email address to "<b>Add
to Contacts</b>" (see Figure 12). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 592px; height: 445px;"
 alt="Signing e-mail" src="outlookadd.gif"><br>
      <b>Figure 12.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> In the Contacts window, click on the "<b>Save and Close</b>"
button near the top left-hand corner (or from the "<b>File</b>" menu)
to add this person to your Address Book. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> After you've done this, you can then verify that they have a
digital certificate by opening your Address Book, highlighting the
individual, and clicking on Properties (see Figure 13). Then click on
the "<b>Certificates</b>" tab at the top, and the resulting window
should appear similar to Figure 10. You should see digital IDs, or
certificates, associated with this person. This enables you to send
them encrypted email (read below for more information). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 480px; height: 409px;"
 alt="Outlook address book entry" src="outlookaddressbook.gif"><br>
      <b>Figure 13.</b> </td>
    </tr>
  </tbody>
</table>
<b><br>
</b>
<hr><b><br>
<a name="encryption"></a>
Encrypting Email
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td> Now that you have your recipient's digital certificate in
your computer, it's very easy to send an encrypted email. Go to compose
an email as you normally would. However, before sending it, on the top
menubar, click on "<b>View | Options</b>" to bring up the "<b>Message
Options</b>" window, and then click the <span
 style="font-weight: bold;">Security Settings...</span> button, which
should look familiar to that illustrated by
Figure 14. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 806px; height: 814px;"
 alt="message options" src="outlookoptions.gif"><br>
      <b>Figure 14.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> To encrypt your email message, click on the checkbox
entitled "<b>Encrypt message contents and attachments</b>" near the top
left-hand corner of this window. Click on the "<b>OK</b>" button at
the bottom to close the Security Properties dialog and "<span
 style="font-weight: bold;">Close</span>" to exit the Message Options
window. Send your email, and the recipient
will then be able to decrypt the email when s/he receives it by
entering the passphrase to his/her private key when prompted. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Please note that if you do not have the recipient's digital
certificate in Outlook's database, you <b>cannot</b> send encrypted
email to them. If you try, you will see an error message (shown in
Figure 18) which will notify you that you do not have the recipient's
digital certificate. At this point, you may choose to either send the
email un-encrypted, or cancel the message altogether. Please read the
above section entitled "Retrieving Other People's Digital Certificates"
if you wish to send them an encrypted email. Other mail clients (such
as Mozilla) will get the certificates automatically from the LDAP
server.<br>
      </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 462px; height: 241px;"
 alt="Non-secure recipients" src="outlooknocert.gif"><br>
      <b>Figure 18.</b> </td>
    </tr>
  </tbody>
</table>
<b><br>
</b>
<hr><b><br>
<a name="signing"></a>
Digitally Signing Email
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td> Digitally signing email is similar to the procedure outlined
just above for sending encrypting email. The only difference is that
you will have to check the box marked "<b>Add digital signature to
outgoing message</b>" (see Figure 17) before sending your message, and
when you are ready to send your digitally signed email, you will be
prompted to enter the passphrase for your digital certificate (see
Figure 19). After you enter it, your email will be sent, digitally
signed. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 517px; height: 336px;"
 alt="Signing password" src="outlookpassphrase.gif"><br>
      <b>Figure 19.</b> </td>
    </tr>
  </tbody>
</table>
<b><br>
</b>
<hr><b><br>
<a name="both"></a>
Encrypting and Digitally Signing Email
</b> You can send email that is both encrypted and digitally signed as
well! To do this, you must make sure that before sending your email,
both the "<b>Encrypt message contents and attachments</b>" and "<b>Add
digital signature to outgoing message</b>" boxes are checked (see
Figure 17). You must have already retrieved the recipient's digital
certificate onto your computer (please read the above section entitled
"Retrieving Other People's Digital Certificates" if you haven't done
so), and you will also be prompted to enter the passphrase for your
digital certificate (see Figure 19). After you have done so, the email
will be sent to the recipient encrypted and digitally signed by you!
</body>
</html>
