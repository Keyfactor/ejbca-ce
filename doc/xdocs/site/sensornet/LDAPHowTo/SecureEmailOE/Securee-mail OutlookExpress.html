<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta content="text/html; charset=ISO-8859-15"
 http-equiv="content-type">
  <title>Secure e-mail with Outlook Express</title>
  <meta content="James A. Rome" name="author">
</head>
<body>
<div style="text-align: center; color: rgb(0, 102, 0);">
<h2>SensorNet and Digital Certificates:</h2>
</div>
<h2 style="text-align: center;"><span style="color: rgb(0, 0, 153);">Using
Secure Email with Microsoft Outlook Express</span> </h2>
<br>
<ul>
  <li><a
 href="#getcert">Retrieving
Other People's Digital Certificates</a> </li>
  <li><a
 href="#encryption">Encrypting
Email</a> </li>
  <li><a
 href="#signing">Digitally
Signing Email</a> </li>
  <li><a
 href="#both">Encrypting
and Digitally Signing Email </a></li>
</ul>

<a name="getcert"></a>
<b>Retrieving Other People's Digital Certificates
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td> By now, you probably know that in order to send secure
(specifically, encrypted) email to an individual involved in SensorNet
you will
need their public key (contained within their digital certificate). How
do you get their public key? Well, at SensorNet, we store people's
certificates in our online directory (LDAP). You can easily retrieve
their certificates via the directory and place them into your computer.
Listed below are the steps on how to do this. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> First, we're going to make a new directory for Outlook
Express. On the top menubar, go to "<b>Tools</b>" and then "<b>Accounts</b>"
(see Figure 1). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 779px; height: 530px;"
 alt="New account" src="oetools.gif"><br>
      <b>Figure 1.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> In the new window, click on the "<b>Directory Service</b>"
tab on top (see Figure 2). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 674px; height: 381px;"
 alt="Accounts" title="Accounts" src="oeaccount.jpg"><br>
      <b>Figure 2.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Now click on the "<b>Add</b>" button at the top right hand
corner of the window. Choose "<b>Directory Service</b>" (See Figure 3).
      </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img
 src="outlookdirectory1.gif" alt="Directory Service"><br>
      <b>Figure 3.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> You'll now be instructed to enter various bits of
information on different screens. On the first screen, type in "<b>ldap.sensornet.gov</b>"
for the "<b>Internet directory (LDAP) server</b>" field. Click on "<b>Next</b>"
when you are finished (see Figure 4). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 668px; height: 460px;"
 alt="New LDAP" src="oedirectservname.png"><br>
      <b>Figure 4.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> On the second page, click "<b>Yes</b>" when asked "<b>Do you
want to check addresses using this directory service?</b>". Click on "<b>Next</b>"
when you are finished (see Figure 5). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 668px; height: 460px;"
 alt="use LDAP?" src="oecheckemail.jpg"><br>
      <b>Figure 5.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> You will now be at a window which confirms that you have
successfully entered in all of your information. Click on "<b>Finish</b>"
(see Figure 6). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 667px; height: 450px;"
 alt="Finished" src="oecongrats.png"><br>
      <b>Figure 6.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> In the window illustrated by <b>Figure 7</b>, you should
now see an entry for "<b>ldap.sensornet.gov</b>" under the <b>Directory
Service</b> tab. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 671px; height: 377px;"
 alt="Internet accounts" src="oeclickonproperties.png"><br>
      <b>Figure 7.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Now, making sure that the "<b>ldap.sensornet.gov</b>" entry
is
highlighted, click on the "<b>Properties</b>" button on the right hand
side of your window. You should see a window that appears similar to
that illustrated by Figure 8. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 482px; height: 535px;"
 alt="LDAP properties" src="oeproperties.gif"><br>
      <b>Figure 8.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> On this new window, click on the "<b>Advanced</b>" tab. The
window should now appear as shown in Figure 9. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 484px; height: 541px;"
 alt="LDAP advanced properties" src="oeadvprop.png"><br>
      <b>Figure 9.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> For the search base, enter exactly<br>
      <center> "<b>dc=sensornet,dc=gov</b>" </center>
      <br>
Click on the SSL connection button and the port should change to 636 as
shown in Figure 9. Then then click on the "<b>OK</b>" button to
continue (See Figure 10). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Now we have to set up Outlook Express to use digital
certificates. Go to "<b>Tools | Options</b>" from the top menubar.
Select "<b>Security</b>" from the tabs, and then click on the "<b>Advanced</b>"
button near the bottom. You should then see a new window illustrated by
Figure 10.<br>
      <br>
In this window, make sure that "<b>168 bits</b>" is the option selected
in the drop-down menu, and that the checkboxes marked "<b>Always
encrypt to myself when sending encrypted mail</b>", "<b>Include my
digital ID when sending signed messages</b>", and "<b>Add senders'
certificates to my address book</b>" are all checked. Press "<b>OK</b>"
when done. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 633px; height: 551px;"
 alt="Advanced security settings" src="oeadvanced.png"><br>
      <b>Figure 10.</b> </td>
    </tr>
  </tbody>
</table>
<b><br>
<a name="search"></a>
</b>
<table style="text-align: left; margin-left: auto; margin-right: auto;"
 border="0">
  <tbody>
    <tr>
      <td> Now we can search for SensorNet User's's digital
certificates. On the main menubar, click on "<b>Tools | Address Book</b>".
In
the Address Book window, click on the "<b>Find People</b>" button. You
should now be a window that looks like the one illustrated by Figure
11. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 480px; height: 570px;"
 alt="Find people" src="outlookfindpeople.gif"><br>
      <b>Figure 11.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Make sure that the SensorNet LDAP directory that you
specified above
is in the "<b>Look in</b>" drop-down menu. Now, supply either the name
or the email address of the recipient to whom you wish to send
encrypted email, and click on the "<b>Find Now</b>" button. You'll see
the entry (or entries) show up in the lower half of the window.
Highlight the desired entry, and then click on the "<b>Properties</b>"
button. You'll see another window pop up, which should look like the
one illustrated by Figure 12. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 665px; height: 508px;"
 alt="Contact properties" src="oecontactproperties2.png"><br>
      <b>Figure 12.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Click on the "<b>Add to Address Book</b>" button near the
top right-hand corner, and then select the "<b>Digital IDs</b>" tab at
the top. If you see any listings for the person(s) you searched, it
means that you are able to send encrypted email to them! (See Figure
13) Be sure to import any certificates for people you wish to send
e-mail to following the same procedure.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td
 style="vertical-align: top; background-color: rgb(255, 204, 153);">
      <h2 style="background-color: rgb(255, 204, 153);">A good reason
NOT to use Outlook Express</h2>
Note that I imported my own certificate into the Outlook Express
Address Book. The ONLY way to do this (that I have found) is to do it
from an LDAP server as shown above. This is very non-standard. You can
import a certificate file into Outlook Express by using the usual
Internet Explorer import process (Tools, Options, Security, Digital
IDs) but these certificates will not appear when you try to set the
signing certificate for this account. So, after you import your own
certificate into the Address Book, go into your mail server properties
and select the signing certificate that will be used when you send
mail. (Figure 12a) <br>
      <br>
We highly recommend the Mozilla browser, or its separate components
Firefox (browser) and Thunderbird (mail client). It will make your life
easier.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="text-align: center;">&nbsp;<img
 style="width: 493px; height: 562px;"
 alt="Select the signing certificate for your account"
 src="oeSigningCert.png"><br>
      <span style="font-weight: bold;">Figure 12a</span><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 670px; height: 515px;"
 alt="Certificate properties" src="outlookcert_properties.gif"><br>
      <b>Figure 13.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Congratulations! The person's digital certificate has been
imported to your computer. You can now send this person encrypted
email. You can see the certificate by selecting the Tools menu,
Options, and in the security tab click Digital IDs as shown in Figure
14.<br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr align="center">
      <td style="vertical-align: top;"><img
 style="width: 581px; height: 965px;" alt="Imported certificate"
 src="importedcert.png"><br>
      <span style="font-weight: bold;">Figure 14</span><br>
      </td>
    </tr>
  </tbody>
</table>
<b><br>
<a name="alt"></a>
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td><big><big><i>An alternate method...</i></big></big><br>
      <br>
There is also another method of retrieving a person's digital
certificate. Anyone who sends you a digitally signed email will already
have their email address and digital certificate automatically added to
your Address Book. You can verify this by opening your Address Book,
highlighting the individual (whom, as you can see, has been
automatically added), and clicking on Properties. You should see a
window similar to that illustrated by Figure 15. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img
 src="oecontactproperties.jpg" alt="Contact Properties"><br>
      <b>Figure 15.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> To see that this person has a digital certificate, click on
the "<b>Digital IDs</b>" tab of their entry in your Address Book, and
the resulting window should appear similar to Figure 14. You should see
digital IDs, or certificates, associated with this person. This enables
you to send them encrypted email (read below for more information). </td>
    </tr>
  </tbody>
</table>
<b><br>
</b>
<hr><b><br>
<a name="encryption"></a>
Encrypting Email
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td> Now that you have your recipient's digital certificate in
your computer, it's very easy to send an encrypted email. Go to compose
an email as you normally would. However, before sending it, on the top
toolbar, click on the "<b>Encrypt</b>" icon (you can also do this by
selecting "<b>Encrypt</b>" from the "<b>Tools</b>" menubar). You should
see a small blue lock appear near the top right-hand corner of the
window (see Figure 16). Send your email, and the recipient will then be
able to decrypt the email when s/he receives it by entering the
passphrase to his/her private key when prompted. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 791px; height: 418px;"
 alt="Send encrypted mail" src="oeencrypt.png"><br>
      <b>Figure 16.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> Please note that if you do not have the recipient's digital
certificate in Outlook Express's database, you cannot send encrypted
email to them. If you try, you will see an error message which will
notify you that you do not have the recipient's
digital certificate. At this point, you may choose to either send the
email un-encrypted, or cancel the message altogether. Please read the
above section entitled "Retrieving Other People's Digital Certificates"
if you wish to send them an encrypted email. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td
 style="text-align: left; background-color: rgb(255, 204, 153);">
      <h2>Another good reason NOT to use Outlook Express:</h2>
If you try to send the above message, you will find that an error
message appears (figure 17) telling you that the message is being sent
with only 40-bit encryption. Microsoft claims this is a feature (<a
 href="http://support.microsoft.com/default.aspx?scid=kb;en-us;262003">http://support.microsoft.com/default.aspx?scid=kb;en-us;262003</a>)!<br>
      <br>
"This issue is by design following the Secure/Multipurpose Internet
Mail
Extensions 2 (S/MIME2) specification. There are many e-mail clients
that do not support Secure/Multipurpose Internet Mail Extensions 3
(S/MIME3), so the S/MIME2 default (RC2 40-bit) is used for encryption
when Outlook Express does not know the capabilities of the recipient."
This is of course ancient poppycock, and another example of why
Microsoft cannot be relied upon to properly handle PKI. Do yourself a
favor and switch to Mozilla. Mozilla also does not force you to
manually import the certificate into the address book. It does it
automagically. </td>
    </tr>
    <tr>
      <td style="vertical-align: top;"><br>
      </td>
    </tr>
    <tr>
      <td style="vertical-align: top;">
      <div style="text-align: center;"><img
 style="width: 793px; height: 414px;"
 alt="Outlook Express cannot use strong encryption" src="40-bit.png"><br>
      </div>
      <div style="text-align: center;"><span style="font-weight: bold;">Figure
17</span><br>
      </div>
      </td>
    </tr>
  </tbody>
</table>
<b><br>
</b>
<hr><b><br>
<a name="signing"></a>
Digitally Signing Email
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td> Digitally signing email is similar to the procedure outlined
just above for sending encrypting email. The only difference is that
you will have to click on the "<b>Digitally sign</b>" icon (or choose "<b>Digitally
Sign</b>" in "<b>Tools</b>" from the menubar) before sending your
email. You should see a small red ribbon appear near the top right-hand
corner of the window (see Figure 18). </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img style="width: 790px; height: 414px;"
 alt="Signed e-mail" src="oesign.gif"><br>
      <b>Figure 18.</b> </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> When you are ready to send your digitally signed email, you
will be prompted to enter the passphrase for your digital certificate
(see Figure 19). After you enter it, your email will be sent, digitally
signed. </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td align="center"> <img
 src="outlookpassphrase.gif" alt="Outlook passphrase"><br>
      <b>Figure 19.</b> </td>
    </tr>
  </tbody>
</table>
<b><br>
</b>
<hr><b><br>
<a name="both"></a>
Encrypting and Digitally Signing Email
</b>
<table align="center" border="0">
  <tbody>
    <tr>
      <td> You can send email that is both encrypted and digitally
signed as well! To do this, you must make sure that before sending your
email, both the "<b>Encrypt</b>" and "<b>Digitally Signed</b>" icons
are clicked in the toolbar (you can also do this in the "<b>Tools</b>"
option from the menubar). You should see a small blue lock and a small
red ribbon appear near the top right-hand corner of the window </td>
    </tr>
    <tr>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td> You must have already retrieved the recipient's digital
certificate onto your computer (please read the above section entitled
"Retrieving Other People's Digital Certificates" if you haven't done
so), and you will also be prompted to enter the passphrase for your
digital certificate (see Figure 19). After you have done so, the email
will be sent to the recipient encrypted and digitally signed by you!</td>
    </tr>
  </tbody>
</table>
</body>
</html>
