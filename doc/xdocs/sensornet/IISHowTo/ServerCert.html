<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Server Certificates for IIS</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>

<body>
<table width="100%" border="0">
  <tr>
    <td><h1><font color="#006666">Obtaining a Server Certificate for IIS</font></h1></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><p>For the SensorNet Certificate Authority (CA), the function of the
        certificate request is to generate a key pair. The private key is stored
        in a Windows
        key store, and the public key is sent to the SensorNet CA, where it is
        extracted and embedded in a certificate that is signed and sent back
        to you. Therefore, the DN you choose when you run the Certificate Application
      Wizard will be ignored.</p>
      <p>So, the <font color="#990000">first step is to request a certificate
          from the CA</font>, Jim Rome
        (romeja@ornl.gov). The e-mail should contain:</p>
      <ul>
        <li>The ip name of your server</li>
        <li>Your name and e-mail address</li>
        <li>Your phone number</li>
        <li>Your Organization</li>
        <li>Your Organizational Unit</li>
        <li>Your City</li>
        <li>Your State</li>
        <li>Your Country</li>
      </ul>
      <p>When your request is approved, you will receive an e-mail telling you
        where to get the certificate and containing a user ID and password. At
      that point you will need to generate the certificate request for IIS. </p>
      <p>To do this, launch the Internet Information Services management console
        from the Administrative Tools menu (Fig. 1).</p></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><div align="center">
      <p><img src="AdminTools.png" width="559" height="232"></p>
      <p>Figure 1. </p>
    </div></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>From the IIS console, expand your Web site tree and right-click on your
      Web site to access the properties menu (Fig. 2).</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><div align="center">
      <p><img src="OpenProperties.png" width="638" height="477"></p>
      <p>Figure 2.</p>
    </div></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Click the Directory Security tab for the Web Site Properties to access
      the Server Certificate button (Fig. 3).</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><div align="center">
      <p><img src="AccessServerCert.png" width="608" height="550"></p>
      <p>Figure 3.</p>
    </div></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Click the Server Certificate button to launch the Web Server Certificate
      Wizard (Fig. 4). </td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><div align="center">
      <p><img src="CertWizard.png" width="638" height="443"></p>
      <p>Figure 4.</p>
    </div></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>As we said at the outset, it really does not matter what data you enter
      into the wizard. Just be sure to choose the Create New Certificate option
      (Fig. 5). When the wizard finishes, it creates the file C:\certreq.txt
      which is what
      you use to send your public key to the SensorNet CA.</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><div align="center">
      <p><img src="NewCert.png" width="479" height="360"></p>
      <p>Figure 5.</p>
    </div></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Go to [link removed] as shown in Fig. 6.</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td><div align="center">
      <p><img src="Enrollment.png" width="780" height="595"></p>
      <p>Figure 6.</p>
    </div></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>Be sure to include all of the Text in the request. Use the
      Username and Password you received in the e-mail. When you click OK, you
      will be asked to save a certificate file. Store it somewhere you can remember
      (I use a keys folder). Then return to the Microsoft Web Server Certificate
      Wizard and select &quot;Complete the request&quot;. Search for the certificate file
      (you will have to enable all files in the search dialog because the SensorNetCA
      certificate file is not a .cer file), select it, and when you click OK,
      it will be installed.</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
  </tr>
</table>
</body>
</html>
